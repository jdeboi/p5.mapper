{"version":3,"file":"p5.mapper.js","mappings":"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","sources":["webpack://p5.mapper/webpack/universalModuleDefinition","webpack://p5.mapper/webpack/bootstrap","webpack://p5.mapper/webpack/runtime/define property getters","webpack://p5.mapper/webpack/runtime/hasOwnProperty shorthand","webpack://p5.mapper/./src/perspective/numeric.js","webpack://p5.mapper/./src/perspective/PerspT.js","webpack://p5.mapper/./src/surfaces/Draggable.ts","webpack://p5.mapper/./src/surfaces/MovePoint.ts","webpack://p5.mapper/./src/surfaces/MeshPoint.ts","webpack://p5.mapper/./src/helpers/helpers.ts","webpack://p5.mapper/./src/surfaces/Surface.ts","webpack://p5.mapper/./src/surfaces/CornerPinSurface.ts","webpack://p5.mapper/./src/surfaces/QuadMap.ts","webpack://p5.mapper/./src/surfaces/TriMap.ts","webpack://p5.mapper/./src/surfaces/PolyMap.ts","webpack://p5.mapper/./src/surfaces/Bezier/BezierPoint.ts","webpack://p5.mapper/./src/surfaces/Bezier/BezierMap.ts","webpack://p5.mapper/./src/surfaces/LineMap.ts","webpack://p5.mapper/./src/ProjectionMapper.ts"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"p5.mapper\"] = factory();\n\telse\n\t\troot[\"p5.mapper\"] = factory();\n})(this, () => {\nreturn ","// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","var numeric = {};\n\nnumeric.dim = function dim(x) {\n  var y, z;\n  if (typeof x === \"object\") {\n    y = x[0];\n    if (typeof y === \"object\") {\n      z = y[0];\n      if (typeof z === \"object\") {\n        return numeric._dim(x);\n      }\n      return [x.length, y.length];\n    }\n    return [x.length];\n  }\n  return [];\n};\n\nnumeric._foreach2 = function _foreach2(x, s, k, f) {\n  if (k === s.length - 1) {\n    return f(x);\n  }\n  var i,\n    n = s[k],\n    ret = Array(n);\n  for (i = n - 1; i >= 0; i--) {\n    ret[i] = _foreach2(x[i], s, k + 1, f);\n  }\n  return ret;\n};\n\nnumeric.cloneV = function (x) {\n  var _n = x.length;\n  var i,\n    ret = Array(_n);\n\n  for (i = _n - 1; i !== -1; --i) {\n    ret[i] = x[i];\n  }\n  return ret;\n};\n\nnumeric.clone = function (x) {\n  if (typeof x !== \"object\") return x;\n  var V = numeric.cloneV;\n  var s = numeric.dim(x);\n  return numeric._foreach2(x, s, 0, V);\n};\n\nnumeric.diag = function diag(d) {\n  var i,\n    i1,\n    j,\n    n = d.length,\n    A = Array(n),\n    Ai;\n  for (i = n - 1; i >= 0; i--) {\n    Ai = Array(n);\n    i1 = i + 2;\n    for (j = n - 1; j >= i1; j -= 2) {\n      Ai[j] = 0;\n      Ai[j - 1] = 0;\n    }\n    if (j > i) {\n      Ai[j] = 0;\n    }\n    Ai[i] = d[i];\n    for (j = i - 1; j >= 1; j -= 2) {\n      Ai[j] = 0;\n      Ai[j - 1] = 0;\n    }\n    if (j === 0) {\n      Ai[0] = 0;\n    }\n    A[i] = Ai;\n  }\n  return A;\n};\n\nnumeric.rep = function rep(s, v, k) {\n  if (typeof k === \"undefined\") {\n    k = 0;\n  }\n  var n = s[k],\n    ret = Array(n),\n    i;\n  if (k === s.length - 1) {\n    for (i = n - 2; i >= 0; i -= 2) {\n      ret[i + 1] = v;\n      ret[i] = v;\n    }\n    if (i === -1) {\n      ret[0] = v;\n    }\n    return ret;\n  }\n  for (i = n - 1; i >= 0; i--) {\n    ret[i] = numeric.rep(s, v, k + 1);\n  }\n  return ret;\n};\n\nnumeric.identity = function (n) {\n  return numeric.diag(numeric.rep([n], 1));\n};\n\nnumeric.inv = function inv(a) {\n  var s = numeric.dim(a),\n    abs = Math.abs,\n    m = s[0],\n    n = s[1];\n  var A = numeric.clone(a),\n    Ai,\n    Aj;\n  var I = numeric.identity(m),\n    Ii,\n    Ij;\n  var i, j, k, x;\n  for (j = 0; j < n; ++j) {\n    var i0 = -1;\n    var v0 = -1;\n    for (i = j; i !== m; ++i) {\n      k = abs(A[i][j]);\n      if (k > v0) {\n        i0 = i;\n        v0 = k;\n      }\n    }\n    Aj = A[i0];\n    A[i0] = A[j];\n    A[j] = Aj;\n    Ij = I[i0];\n    I[i0] = I[j];\n    I[j] = Ij;\n    x = Aj[j];\n    for (k = j; k !== n; ++k) Aj[k] /= x;\n    for (k = n - 1; k !== -1; --k) Ij[k] /= x;\n    for (i = m - 1; i !== -1; --i) {\n      if (i !== j) {\n        Ai = A[i];\n        Ii = I[i];\n        x = Ai[j];\n        for (k = j + 1; k !== n; ++k) Ai[k] -= Aj[k] * x;\n        for (k = n - 1; k > 0; --k) {\n          Ii[k] -= Ij[k] * x;\n          --k;\n          Ii[k] -= Ij[k] * x;\n        }\n        if (k === 0) Ii[0] -= Ij[0] * x;\n      }\n    }\n  }\n  return I;\n};\n\nnumeric.dotMMsmall = function dotMMsmall(x, y) {\n  var i, j, k, p, q, r, ret, foo, bar, woo, i0;\n  p = x.length;\n  q = y.length;\n  r = y[0].length;\n  ret = Array(p);\n  for (i = p - 1; i >= 0; i--) {\n    foo = Array(r);\n    bar = x[i];\n    for (k = r - 1; k >= 0; k--) {\n      woo = bar[q - 1] * y[q - 1][k];\n      for (j = q - 2; j >= 1; j -= 2) {\n        i0 = j - 1;\n        woo += bar[j] * y[j][k] + bar[i0] * y[i0][k];\n      }\n      if (j === 0) {\n        woo += bar[0] * y[0][k];\n      }\n      foo[k] = woo;\n    }\n    ret[i] = foo;\n  }\n  return ret;\n};\n\nnumeric.dotMV = function dotMV(x, y) {\n  var p = x.length,\n    i;\n  var ret = Array(p),\n    dotVV = numeric.dotVV;\n  for (i = p - 1; i >= 0; i--) {\n    ret[i] = dotVV(x[i], y);\n  }\n  return ret;\n};\n\nnumeric.dotVV = function dotVV(x, y) {\n  var i,\n    n = x.length,\n    i1,\n    ret = x[n - 1] * y[n - 1];\n  for (i = n - 2; i >= 1; i -= 2) {\n    i1 = i - 1;\n    ret += x[i] * y[i] + x[i1] * y[i1];\n  }\n  if (i === 0) {\n    ret += x[0] * y[0];\n  }\n  return ret;\n};\n\nnumeric.transpose = function transpose(x) {\n  var i,\n    j,\n    m = x.length,\n    n = x[0].length,\n    ret = Array(n),\n    A0,\n    A1,\n    Bj;\n  for (j = 0; j < n; j++) ret[j] = Array(m);\n  for (i = m - 1; i >= 1; i -= 2) {\n    A1 = x[i];\n    A0 = x[i - 1];\n    for (j = n - 1; j >= 1; --j) {\n      Bj = ret[j];\n      Bj[i] = A1[j];\n      Bj[i - 1] = A0[j];\n      --j;\n      Bj = ret[j];\n      Bj[i] = A1[j];\n      Bj[i - 1] = A0[j];\n    }\n    if (j === 0) {\n      Bj = ret[0];\n      Bj[i] = A1[0];\n      Bj[i - 1] = A0[0];\n    }\n  }\n  if (i === 0) {\n    A0 = x[0];\n    for (j = n - 1; j >= 1; --j) {\n      ret[j][0] = A0[j];\n      --j;\n      ret[j][0] = A0[j];\n    }\n    if (j === 0) {\n      ret[0][0] = A0[0];\n    }\n  }\n  return ret;\n};\n\nexport default numeric;\n","import numeric from \"./numeric\";\n\nfunction round(num) {\n  return Math.round(num * 10000000000) / 10000000000;\n}\n\nfunction getNormalizationCoefficients(srcPts, dstPts, isInverse) {\n  if (isInverse) {\n    var tmp = dstPts;\n    dstPts = srcPts;\n    srcPts = tmp;\n  }\n  var r1 = [\n    srcPts[0],\n    srcPts[1],\n    1,\n    0,\n    0,\n    0,\n    -1 * dstPts[0] * srcPts[0],\n    -1 * dstPts[0] * srcPts[1],\n  ];\n  var r2 = [\n    0,\n    0,\n    0,\n    srcPts[0],\n    srcPts[1],\n    1,\n    -1 * dstPts[1] * srcPts[0],\n    -1 * dstPts[1] * srcPts[1],\n  ];\n  var r3 = [\n    srcPts[2],\n    srcPts[3],\n    1,\n    0,\n    0,\n    0,\n    -1 * dstPts[2] * srcPts[2],\n    -1 * dstPts[2] * srcPts[3],\n  ];\n  var r4 = [\n    0,\n    0,\n    0,\n    srcPts[2],\n    srcPts[3],\n    1,\n    -1 * dstPts[3] * srcPts[2],\n    -1 * dstPts[3] * srcPts[3],\n  ];\n  var r5 = [\n    srcPts[4],\n    srcPts[5],\n    1,\n    0,\n    0,\n    0,\n    -1 * dstPts[4] * srcPts[4],\n    -1 * dstPts[4] * srcPts[5],\n  ];\n  var r6 = [\n    0,\n    0,\n    0,\n    srcPts[4],\n    srcPts[5],\n    1,\n    -1 * dstPts[5] * srcPts[4],\n    -1 * dstPts[5] * srcPts[5],\n  ];\n  var r7 = [\n    srcPts[6],\n    srcPts[7],\n    1,\n    0,\n    0,\n    0,\n    -1 * dstPts[6] * srcPts[6],\n    -1 * dstPts[6] * srcPts[7],\n  ];\n  var r8 = [\n    0,\n    0,\n    0,\n    srcPts[6],\n    srcPts[7],\n    1,\n    -1 * dstPts[7] * srcPts[6],\n    -1 * dstPts[7] * srcPts[7],\n  ];\n\n  var matA = [r1, r2, r3, r4, r5, r6, r7, r8];\n  var matB = dstPts;\n  var matC;\n\n  try {\n    matC = numeric.inv(numeric.dotMMsmall(numeric.transpose(matA), matA));\n  } catch (e) {\n    console.log(e);\n    return [1, 0, 0, 0, 1, 0, 0, 0];\n  }\n\n  var matD = numeric.dotMMsmall(matC, numeric.transpose(matA));\n  var matX = numeric.dotMV(matD, matB);\n  for (var i = 0; i < matX.length; i++) {\n    matX[i] = round(matX[i]);\n  }\n  matX[8] = 1;\n\n  return matX;\n}\n\nfunction PerspT(srcPts, dstPts) {\n  if (\n    (typeof window !== \"undefined\" && window === this) ||\n    this === undefined\n  ) {\n    return new PerspT(srcPts, dstPts);\n  }\n\n  this.srcPts = srcPts;\n  this.dstPts = dstPts;\n  this.coeffs = getNormalizationCoefficients(this.srcPts, this.dstPts, false);\n  this.coeffsInv = getNormalizationCoefficients(this.srcPts, this.dstPts, true);\n\n  return this;\n}\n\nPerspT.prototype = {\n  transform: function (x, y) {\n    var coordinates = [];\n    coordinates[0] =\n      (this.coeffs[0] * x + this.coeffs[1] * y + this.coeffs[2]) /\n      (this.coeffs[6] * x + this.coeffs[7] * y + 1);\n    coordinates[1] =\n      (this.coeffs[3] * x + this.coeffs[4] * y + this.coeffs[5]) /\n      (this.coeffs[6] * x + this.coeffs[7] * y + 1);\n    return coordinates;\n  },\n\n  transformInverse: function (x, y) {\n    var coordinates = [];\n    coordinates[0] =\n      (this.coeffsInv[0] * x + this.coeffsInv[1] * y + this.coeffsInv[2]) /\n      (this.coeffsInv[6] * x + this.coeffsInv[7] * y + 1);\n    coordinates[1] =\n      (this.coeffsInv[3] * x + this.coeffsInv[4] * y + this.coeffsInv[5]) /\n      (this.coeffsInv[6] * x + this.coeffsInv[7] * y + 1);\n    return coordinates;\n  },\n};\n\nexport default PerspT;\n","import MeshPoint from \"./MeshPoint\";\nimport MovePoint from \"./MovePoint\";\nimport BezierPoint from \"./Bezier/BezierPoint\";\n\n// Draggable.ts\nexport type Point = { x: number; y: number; u?: number; v?: number };\nexport type Rect = { x: number; y: number; w: number; h: number };\nexport type AxisLock = \"none\" | \"x\" | \"y\";\n\nexport interface DraggableJSON {\n  id?: string | number;\n  x: number;\n  y: number;\n  x0?: number;\n  y0?: number;\n  x1?: number;\n  y1?: number;\n  dragging?: boolean;\n  enabled?: boolean;\n  type?: string;\n  res?: number;\n  width?: number;\n  height?: number;\n  closed?: boolean;\n  auto?: boolean;\n  points?: Array<{ i: number; x: number; y: number; u?: number; v?: number }>;\n}\n\nexport default class Draggable {\n  protected pInst: any;\n\n  public x = 0;\n  public y = 0;\n\n  protected clickX = 0;\n  protected clickY = 0;\n  protected xStartDrag = 0;\n  protected yStartDrag = 0;\n\n  private _dragging = false;\n  private _enabled = true;\n\n  private _bounds: Rect | null = null; // constrain position if set\n  private _grid: [number, number] | null = null; // snap step [gx, gy]\n  private _axis: AxisLock = \"none\"; // lock movement to an axis\n\n  // Optional hooks\n  public onDragStart?: (pos: Point) => void;\n  public onDragMove?: (pos: Point) => void;\n  public onDragEnd?: (pos: Point) => void;\n\n  constructor(pInst: any, x = 0, y = 0) {\n    this.pInst = pInst;\n    this.x = x;\n    this.y = y;\n    this.xStartDrag = x;\n    this.yStartDrag = y;\n  }\n\n  /** Enable/disable dragging */\n  setEnabled(enabled: boolean) {\n    this._enabled = !!enabled;\n    if (!this._enabled && this._dragging) this.endDrag();\n    return this;\n  }\n  get enabled() {\n    return this._enabled;\n  }\n\n  /** Optional axis lock */\n  setLockAxis(axis: AxisLock) {\n    this._axis = axis;\n    return this;\n  }\n\n  /** Constrain moves to a rectangle */\n  setBounds(bounds: Rect | null) {\n    this._bounds = bounds;\n    // Clamp immediately if we already sit outside\n    this.applyBounds();\n    return this;\n  }\n\n  /** Snap moves to a grid step, e.g., [10,10]; set null to disable */\n  setGrid(step: number | [number, number] | null) {\n    if (step == null) this._grid = null;\n    else\n      this._grid = Array.isArray(step)\n        ? [Math.max(1, step[0]), Math.max(1, step[1])]\n        : [Math.max(1, step), Math.max(1, step)];\n    return this;\n  }\n\n  /** Begin dragging from the given pointer (defaults to p5 mouse) */\n  startDrag(mx: number = this.pInst.mouseX, my: number = this.pInst.mouseY) {\n    if (!this._enabled) return;\n    this._dragging = true;\n    this.xStartDrag = this.x;\n    this.yStartDrag = this.y;\n    this.clickX = mx;\n    this.clickY = my;\n    this.onDragStart?.({ x: this.x, y: this.y });\n  }\n\n  /**\n   * Legacy behavior: if called with no args, follow current mouse delta.\n   * Modern behavior: if x,y provided, move absolutely to (x,y).\n   */\n  moveTo(x?: number, y?: number) {\n    if (typeof x === \"number\" && typeof y === \"number\") {\n      // absolute move\n      const pos = this.applyConstraints(x, y);\n      this.x = pos.x;\n      this.y = pos.y;\n      if (this._dragging) this.onDragMove?.({ x: this.x, y: this.y });\n      return;\n    }\n\n    // legacy: follow pointer delta since startDrag\n    const mx = this.pInst.mouseX;\n    const my = this.pInst.mouseY;\n    const nx = this.xStartDrag + (mx - this.clickX);\n    const ny = this.yStartDrag + (my - this.clickY);\n    const pos = this.applyConstraints(nx, ny);\n    this.x = pos.x;\n    this.y = pos.y;\n    if (this._dragging) this.onDragMove?.({ x: this.x, y: this.y });\n  }\n\n  /** Relative move */\n  translate(dx: number, dy: number) {\n    this.moveTo(this.x + dx, this.y + dy);\n  }\n\n  getIsDragging() {\n    return this._dragging;\n  }\n  getIsEnabled() {\n    return this._enabled;\n  }\n\n  /** Update dragging with current pointer */\n  updateDrag(mx: number, my: number) {\n    if (!this._dragging) return;\n    const nx = this.xStartDrag + (mx - this.clickX);\n    const ny = this.yStartDrag + (my - this.clickY);\n    const pos = this.applyConstraints(nx, ny);\n    this.x = pos.x;\n    this.y = pos.y;\n    this.onDragMove?.({ x: this.x, y: this.y });\n  }\n\n  /** Finish dragging */\n  endDrag() {\n    if (!this._dragging) return;\n    this._dragging = false;\n    this.onDragEnd?.({ x: this.x, y: this.y });\n  }\n\n  selectDraggable() {\n    // if the surface itself is selected\n    if (this.isMouseOver()) {\n      this.startDrag();\n      return this;\n    }\n    return null;\n  }\n\n  //   /** Override in subclasses to provide selection */\n  selectPoints(): BezierPoint | MovePoint | MeshPoint | null {\n    throw new Error(\"selectPoints() must be implemented by subclass\");\n  }\n\n  get isDragging() {\n    return this._dragging;\n  }\n\n  /** Directly set position without dragging lifecycle */\n  set(pos: Partial<Point>) {\n    const nx = typeof pos.x === \"number\" ? pos.x : this.x;\n    const ny = typeof pos.y === \"number\" ? pos.y : this.y;\n    const p = this.applyConstraints(nx, ny);\n    this.x = p.x;\n    this.y = p.y;\n    return this;\n  }\n\n  getMouseCoords(): Point {\n    const mx = this.pInst.mouseX - this.pInst.width / 2;\n    const my = this.pInst.mouseY - this.pInst.height / 2;\n    return { x: mx, y: my };\n  }\n\n  /** Override in subclasses to provide hit testing for selection */\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  isMouseOver(): boolean {\n    // Base has no shape; subclasses (e.g., handle, rectangle) should override.\n    console.error(\"isMouseOver() must be implemented by subclass\");\n    return false;\n  }\n\n  /** Apply axis lock, bounds, and grid snapping */\n  protected applyConstraints(nx: number, ny: number): Point {\n    // axis lock\n    if (this._axis === \"x\") ny = this.y;\n    else if (this._axis === \"y\") nx = this.x;\n\n    // bounds\n    if (this._bounds) {\n      const { x, y, w, h } = this._bounds;\n      nx = clamp(nx, x, x + w);\n      ny = clamp(ny, y, y + h);\n    }\n\n    // grid\n    if (this._grid) {\n      const [gx, gy] = this._grid;\n      nx = Math.round(nx / gx) * gx;\n      ny = Math.round(ny / gy) * gy;\n    }\n\n    return { x: nx, y: ny };\n  }\n\n  /** Clamp current x/y to bounds (if any) */\n  protected applyBounds() {\n    if (!this._bounds) return;\n    const p = this.applyConstraints(this.x, this.y);\n    this.x = p.x;\n    this.y = p.y;\n  }\n\n  toJSON(): DraggableJSON {\n    return {\n      x: this.x,\n      y: this.y,\n      dragging: this.getIsDragging(),\n      enabled: this.getIsEnabled(),\n    };\n  }\n\n  //   override load\n  load(data: DraggableJSON) {\n    throw new Error(\"load() must be implemented by subclass\");\n  }\n\n  //   override isEqual\n  isEqual(json: { id: string | number; type: string }): boolean {\n    throw new Error(\"isEqual() must be implemented by subclass\");\n    return true;\n  }\n}\n\nfunction clamp(n: number, a: number, b: number) {\n  return n < a ? a : n > b ? b : n;\n}\n","// MovePoint.ts\nimport Draggable, { DraggableJSON, Point } from \"./Draggable\";\n\ntype MovePointOpts = {\n  radius?: number; // visual radius in px\n  hitScale?: number; // enlarge hit area, e.g. 1.5 = 150%\n  color?: any; // p5 color or anything p5.color() accepts\n};\n\nexport default class MovePoint extends Draggable {\n  public type = \"CPOINT\";\n  public r: number;\n  public isControlPoint = false;\n\n  protected parent: any;\n  protected col: any;\n  protected hitScale: number;\n\n  constructor(\n    parent: any,\n    x: number,\n    y: number,\n    pInst: any,\n    opts: MovePointOpts = {}\n  ) {\n    super(pInst, x, y);\n    this.parent = parent;\n    this.r = opts.radius ?? 8;\n    this.hitScale = Math.max(1, opts.hitScale ?? 1);\n    this.col = opts.color ?? pInst.color(0, 255, 255);\n  }\n\n  /** Set x/y from another point-like object */\n  set(point: Point): this {\n    if (typeof point.x === \"number\") this.x = point.x;\n    if (typeof point.y === \"number\") this.y = point.y;\n    return this;\n  }\n\n  /** Back-compat: move this point to current mouse (in parent's local space) */\n  moveToMouse(): this {\n    const { mxLocal, myLocal } = this.getLocalMouse();\n    this.moveTo(mxLocal, myLocal);\n    return this;\n  }\n\n  /** Mark/unmark as a control point */\n  setControlPoint(cp: boolean): this {\n    this.isControlPoint = !!cp;\n    return this;\n  }\n\n  setRadius(r: number): this {\n    this.r = Math.max(1, r);\n    return this;\n  }\n\n  setColor(c: any): this {\n    this.col = c;\n    return this;\n  }\n\n  setHitScale(scale: number): this {\n    this.hitScale = Math.max(1, scale);\n    return this;\n  }\n\n  /** Fast hit test in parent's local coordinates */\n  isMouseOver(\n    mx: number = this.pInst.mouseX,\n    my: number = this.pInst.mouseY\n  ): boolean {\n    const { mxLocal, myLocal } = this.toLocal(mx, my);\n    const dx = mxLocal - this.x;\n    const dy = myLocal - this.y;\n    const rr = (this.r * this.hitScale) ** 2;\n    return dx * dx + dy * dy <= rr;\n  }\n\n  /** Interpolate (in-place) between two points by factor f in [0,1] */\n  interpolateBetween(start: Point, end: Point, f: number): this {\n    this.x = start.x + (end.x - start.x) * f;\n    this.y = start.y + (end.y - start.y) * f;\n    return this;\n  }\n\n  /** Draw the handle; assume caller already translated by parent.x/parent.y */\n  display(col: any = this.col) {\n    const p = this.pInst;\n    if (typeof p.isMovingPoints === \"function\" && !p.isMovingPoints()) return;\n\n    let c = col;\n    if (this.isMouseOver()) c = p.color(255);\n\n    p.push();\n    // Slight z offset helps in WEBGL to avoid z-fighting if you need it:\n    // p.translate(0, 0, 5);\n    p.stroke(c);\n    p.strokeWeight(2);\n    p.noFill();\n    p.ellipse(this.x, this.y, this.r * 2);\n\n    p.fill(c);\n    p.noStroke();\n    p.ellipse(this.x, this.y, this.r);\n    p.pop();\n  }\n\n  /** JSON snapshot */\n  toJSON(): DraggableJSON & { isControlPoint: boolean; r: number } {\n    return {\n      x: this.x,\n      y: this.y,\n      dragging: this.getIsDragging(),\n      enabled: this.getIsEnabled(),\n      isControlPoint: this.isControlPoint,\n      r: this.r,\n    };\n  }\n\n  // --- helpers -------------------------------------------------------------\n\n  /** Convert a canvas-space point to this point's parent-local space */\n  private toLocal(mx: number, my: number) {\n    const p = this.pInst;\n    const isWEBGL = !!(p as any)?._renderer?.isP3D; // p5 WEBGL flag\n    const px = this.parent?.x ?? 0;\n    const py = this.parent?.y ?? 0;\n\n    // For WEBGL renderer p5 positions mouse in canvas coords with origin top-left,\n    // but your scene coordinates are typically centered; when drawing handles you\n    // usually translate(parent.x, parent.y). To test hits in local space, offset by parent:\n    const mxLocal = (isWEBGL ? mx - p.width / 2 : mx) - px;\n    const myLocal = (isWEBGL ? my - p.height / 2 : my) - py;\n\n    return { mxLocal, myLocal };\n  }\n\n  private getLocalMouse() {\n    return this.toLocal(this.pInst.mouseX, this.pInst.mouseY);\n  }\n}\n","// MeshPoint.ts\nimport { DraggableJSON, Point } from \"./Draggable\";\nimport MovePoint from \"./MovePoint\";\n\ntype UVLike = { u: number; v: number };\ntype XYLike = { x: number; y: number };\ntype PointLike = XYLike & Partial<UVLike>;\n\nfunction clamp01(n: number) {\n  return n < 0 ? 0 : n > 1 ? 1 : n;\n}\n\nexport default class MeshPoint extends MovePoint {\n  public u: number;\n  public v: number;\n\n  constructor(\n    parent: any,\n    x: number,\n    y: number,\n    u: number,\n    v: number,\n    pInst: any\n  ) {\n    super(parent, x, y, pInst);\n    this.u = u;\n    this.v = v;\n  }\n\n  set(point: Point): this {\n    super.set(point);\n    this.u = point.u || 0;\n    this.v = point.v || 0;\n    return this;\n  }\n\n  moveTo() {\n    super.moveTo();\n    this.parent.calculateMesh();\n  }\n\n  /**\n   * This creates a new MeshPoint with (u,v) = (0,0) and does\n   * not modify the current MeshPoint. Its used to generate\n   * temporary points for the interpolation.\n   */\n  interpolateTo(p: { x: number; y: number }, f: number) {\n    let nX = this.x + (p.x - this.x) * f;\n    let nY = this.y + (p.y - this.y) * f;\n    return new MeshPoint(this.parent, nX, nY, 0, 0, this.pInst);\n  }\n\n  //   /** Copy x,y (+u,v if present) from another point-like object. */\n  //   set(point: PointLike): this {\n  //     super.set(point);\n  //     if (typeof point.u === \"number\") this.u = point.u;\n  //     if (typeof point.v === \"number\") this.v = point.v;\n  //     return this;\n  //   }\n\n  //   moveTo(): void {\n  //     super.moveTo();\n  //     // if (notifyParent) this.#notifyParent();\n  //     this.parent.calculateMesh();\n  //   }\n\n  //   translate(dx: number, dy: number, notifyParent = true): this {\n  //     super.moveTo(this.x + dx, this.y + dy);\n  //     // if (notifyParent) this.#notifyParent();\n  //     this.parent.calculateMesh();\n  //     return this;\n  //   }\n\n  //   /** Set UV; optionally clamp to [0,1]. */\n  //   setUV(u: number, v: number, clamp = true): this {\n  //     this.u = clamp ? clamp01(u) : u;\n  //     this.v = clamp ? clamp01(v) : v;\n  //     return this;\n  //   }\n\n  //   /**\n  //    * Interpolate towards another point.\n  //    * @param p target point (x,y used; u,v optional)\n  //    * @param t mix factor in [0,1]\n  //    * @param carryUV if true, also interpolates UVs when available\n  //    */\n  //   interpolateTo(p: PointLike, t: number, carryUV = false): MeshPoint {\n  //     const nx = this.x + (p.x - this.x) * t;\n  //     const ny = this.y + (p.y - this.y) * t;\n\n  //     const hasUV = typeof p.u === \"number\" && typeof p.v === \"number\";\n  //     const nu =\n  //       carryUV && hasUV\n  //         ? (this.u as number) + ((p.u as number) - (this.u as number)) * t\n  //         : 0;\n  //     const nv =\n  //       carryUV && hasUV\n  //         ? (this.v as number) + ((p.v as number) - (this.v as number)) * t\n  //         : 0;\n\n  //     return new MeshPoint(this.parent, nx, ny, nu, nv, this.pInst);\n  //   }\n\n  //   /** A few handy utilities */\n  //   clone(): MeshPoint {\n  //     return new MeshPoint(\n  //       this.parent,\n  //       this.x,\n  //       this.y,\n  //       this.u,\n  //       this.v,\n  //       this.pInst\n  //     );\n  //   }\n\n  //   equals(p: PointLike, eps = 1e-6): boolean {\n  //     return (\n  //       Math.abs(this.x - p.x) <= eps &&\n  //       Math.abs(this.y - p.y) <= eps &&\n  //       (typeof p.u !== \"number\" || Math.abs(this.u - p.u) <= eps) &&\n  //       (typeof p.v !== \"number\" || Math.abs(this.v - p.v) <= eps)\n  //     );\n  //   }\n\n  //   distanceTo(p: XYLike): number {\n  //     const dx = this.x - p.x;\n  //     const dy = this.y - p.y;\n  //     return Math.hypot(dx, dy);\n  //   }\n\n  //   toJSON(): DraggableJSON & { isControlPoint: boolean; r: number } {\n  //     return {\n  //       x: this.x,\n  //       y: this.y,\n  //       dragging: this.getIsDragging(),\n  //       enabled: this.getIsEnabled(),\n  //       isControlPoint: this.isControlPoint,\n  //       r: this.r,\n  //     };\n  //   }\n}\n","// helpers.ts\n\n/** Basic 2D point */\nexport interface Point {\n  x: number;\n  y: number;\n}\n\nexport type P5 = any;\n\n/**\n * Ray-casting point-in-polygon test.\n * `offset` shifts the polygon (useful when polygon points are local to a parent).\n */\nexport function inside(\n  point: Point,\n  polygon: ReadonlyArray<Point>,\n  offset: Point = { x: 0, y: 0 }\n): boolean {\n  const { x, y } = point;\n\n  let isInside = false;\n  for (let i = 0, j = polygon.length - 1; i < polygon.length; j = i++) {\n    const xi = polygon[i].x + offset.x;\n    const yi = polygon[i].y + offset.y;\n    const xj = polygon[j].x + offset.x;\n    const yj = polygon[j].y + offset.y;\n\n    // edges that straddle the horizontal ray at y\n    const straddles = yi > y !== yj > y;\n    if (straddles) {\n      // x coordinate where the edge crosses the ray\n      const xCross = ((xj - xi) * (y - yi)) / (yj - yi) + xi;\n      if (x < xCross) isInside = !isInside;\n    }\n  }\n  return isInside;\n}\n\n/**\n * Deterministic-ish color based on id/type.\n * Returns whatever your p5.color(...) returns (usually a p5.Color).\n */\nexport function getRandomizedColor(\n  id: number,\n  type: string | undefined,\n  p5: any\n): any {\n  const shapeOffset = type ? type.charCodeAt(0) : 2;\n  const offset = (1 + id) * 88 + shapeOffset * 80;\n\n  // flip to HSB, pick a hue, then restore RGB\n  p5.colorMode(p5.HSB, 255);\n  const col = p5.color(offset % 255, 255, 255);\n  p5.colorMode(p5.RGB, 255);\n  return col;\n}\n\n/** Linear 0..1 progress loop over `seconds` (clamped to 0.1..100). */\nexport function getPercent(p5: P5, seconds = 1): number {\n  const s = p5.constrain(seconds, 0.1, 100);\n  return (p5.frameCount / (60 * s)) % 1;\n}\n\n/** Sinusoidal 0..1 wave over `seconds`, with optional phase `offset` (radians). */\nexport function getPercentWave(p5: P5, seconds = 1, offset = 0): number {\n  const s = p5.constrain(seconds, 0.01, 100);\n  return 0.5 + 0.5 * p5.sin((p5.frameCount / (60 * s)) * 2 * p5.PI + offset);\n}\n","// Surface.ts\nimport Draggable, { DraggableJSON } from \"./Draggable\";\nimport { getRandomizedColor, P5 } from \"../helpers/helpers\";\n\nexport interface Bounds {\n  x: number;\n  y: number;\n  w: number;\n  h: number;\n}\n\nexport interface PointXY {\n  x: number;\n  y: number;\n}\n\n/**\n * Base surface: owns dimensions, a p5 buffer, and rendering hooks.\n * Subclasses should override `displaySurface`.\n */\nexport default class Surface extends Draggable {\n  public id: string | number;\n  public type: string;\n  public res: number;\n\n  public width: number;\n  public height: number;\n\n  public controlPointColor: any; // usually p5.Color\n  public buffer: any; // p5.Graphics\n\n  protected pInst: P5;\n  private rafHandle: number | null = null;\n\n  /**\n   * @param id        Identifier for the surface\n   * @param w         width in px\n   * @param h         height in px\n   * @param res       grid resolution per axis (>= 2)\n   * @param type      e.g. \"QUAD\" | \"TRI\"\n   * @param buffer    optional p5.Graphics to draw into\n   * @param pInst     p5 instance\n   */\n  constructor(\n    id: string | number,\n    w: number,\n    h: number,\n    res: number,\n    type: string,\n    buffer: any | null,\n    pInst: P5\n  ) {\n    super(pInst, 0, 0);\n    this.pInst = pInst;\n\n    if (!Number.isInteger(res) || res < 2) {\n      throw new Error(`Surface: res must be an integer >= 2 (got ${res})`);\n    }\n\n    this.id = id;\n    this.type = type;\n    this.res = res;\n\n    // constrain to canvas, but allow 0 (if canvas not sized yet)\n    this.width = this.pInst.constrain(w, 0, Math.max(0, this.pInst.width));\n    this.height = this.pInst.constrain(h, 0, Math.max(0, this.pInst.height));\n\n    // randomized per id/type so all control points match\n    this.controlPointColor = getRandomizedColor(\n      this.id as number,\n      this.type,\n      this.pInst\n    );\n\n    // Offscreen buffer (2D). Create lazily if not provided.\n    this.buffer = buffer ?? this.createBuffer(this.width, this.height);\n  }\n\n  /** internal: create a 2D buffer and clear it */\n  private createBuffer(w: number, h: number): any {\n    const g = this.pInst.createGraphics(\n      Math.max(1, Math.floor(w)),\n      Math.max(1, Math.floor(h))\n    );\n    g.clear();\n    return g;\n  }\n\n  /** Muted version of a p5 color (alpha default 50) */\n  public getMutedControlColor(\n    col: any = this.controlPointColor,\n    alpha = 50\n  ): any {\n    const p = this.pInst;\n    return p.color(p.red(col), p.green(col), p.blue(col), alpha);\n  }\n\n  /** Clear buffer to a color and then draw the textured surface using that buffer */\n  public display(col: any = this.pInst.color(\"black\")): void {\n    if (!this.buffer || this.buffer.width <= 0 || this.buffer.height <= 0)\n      return;\n\n    this.buffer.push();\n    this.buffer.clear();\n    this.buffer.background(col);\n    this.buffer.pop();\n\n    this.displayTexture(this.buffer);\n  }\n\n  /**\n   * Override in subclasses to issue the actual geometry draw calls, e.g.:\n   * - with texture:    isUV=true, arguments are [u0, v0, u1, v1]\n   * - without texture: isUV=false, arguments are ignored\n   */\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  protected displaySurface(isUV = true, u0 = 0, v0 = 0, u1 = 1, v1 = 1): void {\n    // Subclasses must implement drawing (triangles/quads) using current transform + UVs\n    // Example: draw a textured quad with these UVs.\n    // Left as a warning to catch accidental use without overriding.\n    // (Use console.warn sparingly in prod.)\n    console.warn(\"Surface.displaySurface() should be overridden by subclass.\");\n  }\n\n  /**\n   * Draw a sketch into this.surface's buffer, then render that buffer as texture.\n   * @param sketch draws into provided p5.Graphics\n   * @param tX     source crop x (pixels) OR u0 if texW <= 0\n   * @param tY     source crop y (pixels) OR v0 if texH <= 0\n   * @param texW   source crop width (pixels). If <=0, treat tX,tY as u0,v0.\n   * @param texH   source crop height (pixels). If <=0, treat as full [u1,v1]=[1,1].\n   */\n  public displaySketch(\n    sketch: (g: any) => void,\n    tX = 0,\n    tY = 0,\n    texW = 0,\n    texH = 0\n  ): void {\n    if (!this.buffer) this.buffer = this.createBuffer(this.width, this.height);\n    const g = this.buffer;\n    g.push();\n    g.clear();\n    sketch(g);\n    g.pop();\n\n    this.displayTexture(g, tX, tY, texW, texH);\n  }\n\n  /**\n   * Render a texture onto the surface.\n   * Two modes:\n   *  1) Crop mode (texW>0 && texH>0): (tX,tY,texW,texH) in source pixels  mapped to UV [u0,v0,u1,v1]\n   *  2) UV mode   (texW<=0 || texH<=0): (tX,tY) are u0,v0; u1=v1=1 by default\n   */\n  // Surface.ts\n  displayTexture(tex: any, tX = 0, tY = 0, texW = 0, texH = 0) {\n    if (!tex || tex.width <= 0 || tex.height <= 0) return;\n\n    if (texW <= 0) texW = tex.width;\n    if (texH <= 0) texH = tex.height;\n\n    // convert pixel rect  normalized rect\n    const u0 = tX / tex.width;\n    const v0 = tY / tex.height;\n    const u1 = (tX + texW) / tex.width;\n    const v1 = (tY + texH) / tex.height;\n\n    const p = this.pInst;\n    p.push();\n    p.noStroke();\n    p.translate(this.x, this.y);\n\n    // IMPORTANT: normalized UVs\n    p.textureMode(p.NORMAL);\n    p.texture(tex);\n\n    // displaySurface expects (isUV, u0, v0, u1, v1)\n    this.displaySurface(true, u0, v0, u1, v1);\n\n    if (p.isCalibratingMapper()) this.displayCalibration();\n    p.pop();\n  }\n\n  /** Outline + fill overlay used in calibration mode */\n  public displayCalibration(): void {\n    const p = this.pInst;\n    p.push();\n    this.displayOutline();\n    p.pop();\n  }\n\n  /** Draws the outline (no texture). Subclass displaySurface(false) should render the shape edges. */\n  public displayOutline(col: any = this.controlPointColor): void {\n    const p = this.pInst;\n    p.push();\n    p.strokeWeight(3);\n    p.stroke(col);\n    p.fill(this.getMutedControlColor());\n    p.translate(this.x, this.y);\n    this.displaySurface(false);\n    p.pop();\n  }\n\n  /** Compare lightweight identity (id+type) */\n  public isEqual(json: { id: string | number; type: string }): boolean {\n    return (\n      json &&\n      json.id.toString() === this.id.toString() &&\n      json.type === this.type\n    );\n  }\n\n  /** Compute tight bounds of an array of {x,y} points */\n  public getBounds(points: ReadonlyArray<PointXY>): Bounds {\n    if (!points || points.length === 0) return { x: 0, y: 0, w: 0, h: 0 };\n\n    let minX = Infinity,\n      minY = Infinity,\n      maxX = -Infinity,\n      maxY = -Infinity;\n\n    for (const pt of points) {\n      if (pt.x < minX) minX = pt.x;\n      if (pt.y < minY) minY = pt.y;\n      if (pt.x > maxX) maxX = pt.x;\n      if (pt.y > maxY) maxY = pt.y;\n    }\n\n    // floor mins; ceil maxs to ensure coverage\n    minX = Math.floor(minX);\n    minY = Math.floor(minY);\n    maxX = Math.ceil(maxX);\n    maxY = Math.ceil(maxY);\n\n    return {\n      x: minX,\n      y: minY,\n      w: Math.max(0, maxX - minX),\n      h: Math.max(0, maxY - minY),\n    };\n  }\n\n  /**\n   * Set width/height from points bounds (does not move the surface position).\n   * If buffer size changes, we recreate it.\n   */\n  public setDimensions(points: ReadonlyArray<PointXY>): void {\n    const { w, h } = this.getBounds(points);\n    this.setSize(w, h);\n  }\n\n  /** Explicitly resize surface; recreates buffer if dimensions changed. */\n  public setSize(w: number, h: number): void {\n    const newW = Math.max(0, Math.floor(w));\n    const newH = Math.max(0, Math.floor(h));\n    if (newW === this.width && newH === this.height) return;\n\n    this.width = newW;\n    this.height = newH;\n\n    // Recreate buffer to match new size (2D)\n    this.buffer = this.createBuffer(this.width, this.height);\n\n    this.scheduleCalculateMesh();\n  }\n\n  /** rAF-based debounce for heavy recomputes in subclasses */\n  public scheduleCalculateMesh(): void {\n    if (this.rafHandle != null) return;\n\n    // Prefer browser rAF if present\n    const raf = typeof window !== \"undefined\" && window.requestAnimationFrame;\n    if (raf) {\n      this.rafHandle = raf(() => {\n        this.rafHandle = null;\n        if (typeof (this as any).calculateMesh === \"function\") {\n          (this as any).calculateMesh();\n        }\n      });\n    } else {\n      // Fallback (tests / non-DOM)\n      this.rafHandle = setTimeout(() => {\n        this.rafHandle = null;\n        if (typeof (this as any).calculateMesh === \"function\") {\n          (this as any).calculateMesh();\n        }\n      }, 0) as unknown as number;\n    }\n  }\n\n  //   override if it needs this\n  public displayControlPoints() {}\n\n  /** Basic JSON snapshot (dimensions + identity) */\n  public toJSON(): DraggableJSON {\n    return {\n      id: this.id,\n      type: this.type,\n      res: this.res,\n      x: this.x,\n      y: this.y,\n      width: this.width,\n      height: this.height,\n    };\n  }\n}\n","// CornerPinSurface.ts\nimport { DraggableJSON } from \"./Draggable\";\nimport MeshPoint from \"./MeshPoint\";\nimport Surface from \"./Surface\";\n\n/**\n * Small interface so any perspective impl just needs a `transform([x,y])`.\n * E.g., wrap your PerspT or homography util here.\n */\ninterface PerspectiveTransform {\n  transform: (pt: [number, number]) => [number, number];\n}\n\ntype CornerIndex = \"TL\" | \"TR\" | \"BR\" | \"BL\";\n\ntype CornerPinJSON = {\n  id: string | number;\n  res: number;\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n  type: string;\n  points: Array<{ i: number; x: number; y: number; u: number; v: number }>;\n};\n\nexport default class CornerPinSurface extends Surface {\n  /** grid resolution per axis (res x res points) */\n  public res: number;\n\n  /** flattened grid of MeshPoints, row-major (y * res + x) */\n  protected mesh: MeshPoint[] = [];\n\n  /** top-left, top-right, bottom-right, bottom-left indices into mesh */\n  public TL = 0;\n  public TR = 0;\n  public BR = 0;\n  public BL = 0;\n\n  /** control points are exactly the four corners */\n  public controlPoints: MeshPoint[] = [];\n\n  /** perspective transform used for inverse cursor mapping */\n  private perspectiveTransform: PerspectiveTransform | null = null;\n\n  constructor(\n    id: string | number,\n    width: number,\n    height: number,\n    res: number,\n    type: string,\n    buffer: any,\n    pInst: any\n  ) {\n    super(id, width, height, res, type, buffer, pInst);\n\n    if (!Number.isInteger(res) || res < 2) {\n      throw new Error(\n        `CornerPinSurface: res must be an integer >= 2, got ${res}`\n      );\n    }\n    this.res = res;\n\n    this.initMesh();\n    this.calculateMesh(); // abstract in base class, but we call to set initial transform if you compute it there\n  }\n\n  /** index helper (row-major) */\n  private idx(x: number, y: number): number {\n    return y * this.res + x;\n  }\n\n  /** iterate all mesh points */\n  private forEachPoint(\n    fn: (mp: MeshPoint, x: number, y: number, i: number) => void\n  ) {\n    let i = 0;\n    for (let y = 0; y < this.res; y++) {\n      for (let x = 0; x < this.res; x++, i++) {\n        fn(this.mesh[i], x, y, i);\n      }\n    }\n  }\n\n  /** build a regular grid + mark corners as control points */\n  private initMesh(): void {\n    this.mesh = new Array(this.res * this.res);\n\n    // map 0..res-1  0..width/height so corners land exactly on edges\n    const mapX = (gx: number) => (gx / (this.res - 1)) * this.width;\n    const mapY = (gy: number) => (gy / (this.res - 1)) * this.height;\n    const mapU = (gx: number) => gx / (this.res - 1);\n    const mapV = (gy: number) => gy / (this.res - 1);\n\n    for (let y = 0; y < this.res; y++) {\n      for (let x = 0; x < this.res; x++) {\n        const mx = Math.round(mapX(x));\n        const my = Math.round(mapY(y));\n        const u = mapU(x);\n        const v = mapV(y);\n        this.mesh[this.idx(x, y)] = new MeshPoint(\n          this,\n          mx,\n          my,\n          u,\n          v,\n          this.pInst\n        );\n      }\n    }\n\n    this.TL = this.idx(0, 0);\n    this.TR = this.idx(this.res - 1, 0);\n    this.BL = this.idx(0, this.res - 1);\n    this.BR = this.idx(this.res - 1, this.res - 1);\n\n    // corners are control points\n    [this.TL, this.TR, this.BR, this.BL].forEach((i) => {\n      this.mesh[i].setControlPoint(true);\n    });\n\n    this.controlPoints = [\n      this.mesh[this.TL],\n      this.mesh[this.TR],\n      this.mesh[this.BR],\n      this.mesh[this.BL],\n    ];\n  }\n\n  /**\n   * Override in subclasses. Compute any per-frame mesh adjustments and\n   * (recommended) update `this.perspectiveTransform` so cursor mapping works.\n   * Example (pseudo):\n   *   const src = [0,0, width,0, width,height, 0,height];\n   *   const dst = [TL.x,TL.y, TR.x,TR.y, BR.x,BR.y, BL.x,BL.y];\n   *   const persp = PerspT(src, dst); // whatever you use\n   *   this.setPerspectiveTransform({ transform: ([x,y]) => persp.transform(x,y) });\n   */\n  // eslint-disable-next-line @typescript-eslint/no-empty-function\n  protected calculateMesh(): void {}\n\n  /** supply a perspective transform impl (set from calculateMesh) */\n  protected setPerspectiveTransform(pt: PerspectiveTransform | null): void {\n    this.perspectiveTransform = pt;\n  }\n\n  /** JSON  state (applies only stored control points, keeps others) */\n  public load(json: DraggableJSON): void {\n    const { x, y, points } = json;\n    this.x = x;\n    this.y = y;\n\n    for (const p of points || []) {\n      const mp = this.mesh[p.i];\n      if (!mp) continue;\n      mp.x = p.x;\n      mp.y = p.y;\n      mp.u = p.u || 0;\n      mp.v = p.v || 0;\n      mp.setControlPoint(true);\n    }\n    this.calculateMesh();\n  }\n\n  /** state  JSON (only control points are persisted) */\n  public toJSON(): DraggableJSON {\n    const data: DraggableJSON = {\n      id: String(this.id),\n      res: this.res,\n      x: this.x,\n      y: this.y,\n      width: this.width,\n      height: this.height,\n      type: this.type,\n      points: [],\n    };\n\n    this.forEachPoint((mp, _x, _y, i) => {\n      if (mp.isControlPoint) {\n        data.points?.push({ i, x: mp.x, y: mp.y, u: mp.u, v: mp.v });\n      }\n    });\n\n    return data;\n  }\n\n  public getControlPoints(): MeshPoint[] {\n    return this.controlPoints;\n  }\n\n  public selectPoints(): MeshPoint | null {\n    const cp = this.isMouseOverControlPoints();\n    if (cp) {\n      cp.startDrag();\n      return cp;\n    }\n    return null;\n  }\n\n  private isMouseOverControlPoints(): MeshPoint | false {\n    for (const cp of this.controlPoints) {\n      if (cp.isMouseOver()) return cp;\n    }\n    return false;\n  }\n\n  /**\n   * Barycentric point-in-triangle test.\n   * Kept as a utility in case you want click-to-select by face.\n   */\n  protected isPointInTriangle(\n    x: number,\n    y: number,\n    a: { x: number; y: number },\n    b: { x: number; y: number },\n    c: { x: number; y: number }\n  ): boolean {\n    const v0x = c.x - a.x,\n      v0y = c.y - a.y;\n    const v1x = b.x - a.x,\n      v1y = b.y - a.y;\n    const v2x = x - a.x,\n      v2y = y - a.y;\n\n    const dot00 = v0x * v0x + v0y * v0y;\n    const dot01 = v1x * v0x + v1y * v0y;\n    const dot02 = v2x * v0x + v2y * v0y;\n    const dot11 = v1x * v1x + v1y * v1y;\n    const dot12 = v2x * v1x + v2y * v1y;\n\n    const invDen = 1 / (dot00 * dot11 - dot01 * dot01);\n    const u = (dot11 * dot02 - dot01 * dot12) * invDen;\n    const v = (dot00 * dot12 - dot01 * dot02) * invDen;\n\n    return u > 0 && v > 0 && u + v < 1;\n  }\n\n  /** draws corner handles */\n  public displayControlPoints() {\n    const p = this.pInst;\n    p.push();\n    p.translate(this.x, this.y);\n    for (const cp of this.controlPoints) cp.display(this.controlPointColor);\n    p.pop();\n  }\n\n  /**\n   * Map a canvas-space point into the surfaces local (pre-warp) space.\n   * Requires `this.perspectiveTransform` to be set (e.g., in `calculateMesh`).\n   */\n  public getTransformedCursor(cx: number, cy: number) {\n    if (!this.perspectiveTransform)\n      return this.pInst.createVector(cx - this.x, cy - this.y);\n    const [tx, ty] = this.perspectiveTransform.transform([\n      cx - this.x,\n      cy - this.y,\n    ]);\n    return this.pInst.createVector(tx, ty);\n  }\n\n  public getTransformedMouse() {\n    const { x, y } = this.getMouseCoords();\n    return this.getTransformedCursor(x, y);\n  }\n\n  /** 2D cross product helper (kept for completeness) */\n  protected cross2(x0: number, y0: number, x1: number, y1: number) {\n    return x0 * y1 - y0 * x1;\n  }\n}\n","import PerspT from \"../perspective/PerspT\";\nimport CornerPinSurface from \"./CornerPinSurface\";\n\n// type PerspectiveFn = (x: number, y: number) => [number, number];\n\nexport default class QuadMap extends CornerPinSurface {\n  /** We keep resX/resY mirrored to base `res` so the mesh stays consistent. */\n  private resX: number;\n  private resY: number;\n\n  /** Homography mapping src  dst (x,y) */\n\n  constructor(\n    id: string | number,\n    w: number,\n    h: number,\n    res: number,\n    buffer: any,\n    pInst: any\n  ) {\n    super(id, w, h, res, \"QUAD\", buffer, pInst);\n\n    // Keep internal axes in sync with base resolution\n    this.resX = this.res;\n    this.resY = this.res;\n  }\n\n  /**\n   * Returns true if the mouse is over this surface.\n   * We test in *local* space (mouse - surface origin) against the two triangles.\n   */\n  public isMouseOver(): boolean {\n    const { x, y } = this.getMouseCoords();\n    const mx = x - this.x;\n    const my = y - this.y;\n\n    // Two-triangle quad: TL-TR-BL and BL-TR-BR\n    return (\n      this.isPointInTriangle(\n        mx,\n        my,\n        this.mesh[this.TL],\n        this.mesh[this.TR],\n        this.mesh[this.BL]\n      ) ||\n      this.isPointInTriangle(\n        mx,\n        my,\n        this.mesh[this.BL],\n        this.mesh[this.TR],\n        this.mesh[this.BR]\n      )\n    );\n  }\n\n  /**\n   * Computes the homography from the source rect  current corner pins,\n   * then maps every interior grid point.\n   */\n  protected calculateMesh(): void {\n    const srcCorners = [\n      0,\n      0,\n      this.width,\n      0,\n      this.width,\n      this.height,\n      0,\n      this.height,\n    ];\n    const dstCorners = [\n      this.mesh[this.TL].x,\n      this.mesh[this.TL].y,\n      this.mesh[this.TR].x,\n      this.mesh[this.TR].y,\n      this.mesh[this.BR].x,\n      this.mesh[this.BR].y,\n      this.mesh[this.BL].x,\n      this.mesh[this.BL].y,\n    ];\n\n    // PerspT is expected to return an object with transform(x,y)  [x', y']\n    const persp = PerspT(srcCorners, dstCorners);\n\n    const stepX = this.width / (this.resX - 1);\n    const stepY = this.height / (this.resY - 1);\n\n    // Map all grid points except the four pinned corners\n    for (let y = 0; y < this.resY; y++) {\n      for (let x = 0; x < this.resX; x++) {\n        const i = y * this.res + x; // base mesh is res x res\n        if (i === this.TL || i === this.TR || i === this.BR || i === this.BL)\n          continue;\n\n        const sx = x * stepX;\n        const sy = y * stepY;\n\n        const [dx, dy] = persp.transform(sx, sy);\n        this.mesh[i].x = dx;\n        this.mesh[i].y = dy;\n      }\n    }\n  }\n\n  /**\n   * Draw the tessellated quad as two triangles per cell.\n   * When `isUV` is true we pass normalized UVs in [0,1] (Surface sets `textureMode(NORMAL)`).\n   * The four extra params are interpreted as [u0, v0, u1, v1].\n   */\n  protected displaySurface(isUV = true, u0 = 0, v0 = 0, u1 = 1, v1 = 1): void {\n    const p = this.pInst;\n    p.beginShape(p.TRIANGLES);\n\n    for (let x = 0; x < this.resX - 1; x++) {\n      for (let y = 0; y < this.resY - 1; y++) {\n        if (isUV) {\n          this.emitQuadAsTrianglesUV(x, y, u0, v0, u1, v1);\n        } else {\n          this.emitQuadAsTrianglesOutline(x, y);\n        }\n      }\n    }\n\n    p.endShape();\n  }\n\n  /** Calibration draw (grid without texture) */\n  public displayCalibration(): void {\n    this.displayGrid();\n  }\n\n  private displayGrid(col: any = this.controlPointColor): void {\n    const p = this.pInst;\n    p.strokeWeight(2);\n    p.stroke(col);\n    p.fill(this.getMutedControlColor(col));\n\n    p.beginShape(p.TRIANGLES);\n    for (let x = 0; x < this.resX - 1; x++) {\n      for (let y = 0; y < this.resY - 1; y++) {\n        this.emitQuadAsTrianglesOutline(x, y);\n      }\n    }\n    p.endShape();\n  }\n\n  /** Emit two triangles for a cell with proper UVs (normalized 0..1). */\n  private emitQuadAsTrianglesUV(\n    x: number,\n    y: number,\n    u0: number,\n    v0: number,\n    u1: number,\n    v1: number\n  ): void {\n    const i00 = y * this.res + x; // (x,   y)\n    const i10 = y * this.res + (x + 1); // (x+1, y)\n    const i11 = (y + 1) * this.res + (x + 1); // (x+1, y+1)\n    const i01 = (y + 1) * this.res + x; // (x,   y+1)\n\n    // Interpolate UV per-vertex from the quad UV rect\n    // mp.u/mp.v are 0..1 over the original rect; re-map into [u0..u1]/[v0..v1]\n    const put = (i: number) => {\n      const mp = this.mesh[i];\n      const uu = u0 + mp.u * (u1 - u0);\n      const vv = v0 + mp.v * (v1 - v0);\n      this.pInst.vertex(mp.x, mp.y, uu, vv);\n    };\n\n    // Triangle 1: (x,y)  (x+1,y)  (x+1,y+1)\n    put(i00);\n    put(i10);\n    put(i11);\n\n    // Triangle 2: (x,y)  (x+1,y+1)  (x,y+1)\n    put(i00);\n    put(i11);\n    put(i01);\n  }\n\n  /** Emit two triangles for outline/fill only (no UVs). */\n  private emitQuadAsTrianglesOutline(x: number, y: number): void {\n    const i00 = y * this.res + x;\n    const i10 = y * this.res + (x + 1);\n    const i11 = (y + 1) * this.res + (x + 1);\n    const i01 = (y + 1) * this.res + x;\n\n    const v = (i: number) => {\n      const mp = this.mesh[i];\n      this.pInst.vertex(mp.x, mp.y);\n    };\n\n    // Triangle 1\n    v(i00);\n    v(i10);\n    v(i11);\n\n    // Triangle 2\n    v(i00);\n    v(i11);\n    v(i01);\n  }\n\n  // --- Optional: if you ever want to change tessellation dynamically ----\n\n  /** Set a new (square) resolution and rebuild the base mesh accordingly. */\n  public setResolution(res: number): void {\n    const r = Math.max(2, Math.floor(res));\n    if (r === this.res) return;\n    this.res = r;\n    this.resX = r;\n    this.resY = r;\n\n    // Rebuild the base mesh & control points from CornerPinSurface\n    (this as any).initMesh?.();\n    this.calculateMesh();\n  }\n}\n","// TriMap.ts\nimport CornerPinSurface from \"./CornerPinSurface\";\n\ntype UVRect = { u0: number; v0: number; u1: number; v1: number };\n\nexport default class TriMap extends CornerPinSurface {\n  /** Index of the top apex point in the base mesh */\n  private TP!: number;\n\n  constructor(\n    id: string | number,\n    w: number,\n    h: number,\n    res: number,\n    buffer: any,\n    pInst: any\n  ) {\n    super(id, w, h, res, \"TRI\", buffer, pInst);\n    this.setTriMesh();\n  }\n\n  /**\n   * Returns true if the mouse is over this triangular surface.\n   * We evaluate in *local* coordinates (mouse - surface origin).\n   */\n  public isMouseOver(): boolean {\n    const { x, y } = this.getMouseCoords();\n    const mx = x - this.x;\n    const my = y - this.y;\n\n    return this.isPointInTriangle(\n      mx,\n      my,\n      this.mesh[this.TP],\n      this.mesh[this.BL],\n      this.mesh[this.BR]\n    );\n  }\n\n  /**\n   * Configure the triangles control points:\n   * - Apex (TP) at the middle of the top row\n   * - Bottom corners are BL and BR (inherited)\n   * TL/TR are disabled for this triangle surface\n   */\n  private setTriMesh(): void {\n    // Middle of the top row: x = floor((res-1)/2), y = 0\n    const xTop = Math.floor((this.res - 1) / 2);\n    this.TP = 0 * this.res + xTop;\n\n    // Make only TP, BL, BR the control points\n    this.mesh[this.TP].setControlPoint(true);\n    this.mesh[this.TL].setControlPoint(false);\n    this.mesh[this.TR].setControlPoint(false);\n    this.mesh[this.BL].setControlPoint(true);\n    this.mesh[this.BR].setControlPoint(true);\n\n    this.controlPoints = [\n      this.mesh[this.TP],\n      this.mesh[this.BL],\n      this.mesh[this.BR],\n    ];\n  }\n\n  /**\n   * Draw the triangle.\n   * When `isUV` is true, Surface has already set `textureMode(NORMAL)`,\n   * and we pass UVs in [0,1] using the supplied rect (u0,v0,u1,v1).\n   */\n  protected displaySurface(isUV = true, u0 = 0, v0 = 0, u1 = 1, v1 = 1): void {\n    const p = this.pInst;\n    const apex = this.mesh[this.TP];\n    const bl = this.mesh[this.BL];\n    const br = this.mesh[this.BR];\n\n    // Choose UVs: BL  (u0,v1), TP  mid-top ((u0+u1)/2, v0), BR  (u1,v1)\n    const uv: UVRect = { u0, v0, u1, v1 };\n    const uMid = (uv.u0 + uv.u1) * 0.5;\n\n    p.beginShape(p.TRIANGLES);\n\n    if (isUV) p.vertex(bl.x, bl.y, uv.u0, uv.v1);\n    else p.vertex(bl.x, bl.y);\n\n    if (isUV) p.vertex(apex.x, apex.y, uMid, uv.v0);\n    else p.vertex(apex.x, apex.y);\n\n    if (isUV) p.vertex(br.x, br.y, uv.u1, uv.v1);\n    else p.vertex(br.x, br.y);\n\n    p.endShape(p.CLOSE);\n  }\n\n  /** Optional: show an outline/fill in calibration mode */\n  public displayCalibration(): void {\n    const p = this.pInst;\n    const apex = this.mesh[this.TP];\n    const bl = this.mesh[this.BL];\n    const br = this.mesh[this.BR];\n\n    p.push();\n    p.strokeWeight(2);\n    p.stroke(this.controlPointColor);\n    p.fill(this.getMutedControlColor());\n\n    p.beginShape();\n    p.vertex(bl.x, bl.y);\n    p.vertex(apex.x, apex.y);\n    p.vertex(br.x, br.y);\n    p.endShape(p.CLOSE);\n\n    p.pop();\n  }\n}\n","import Surface, { PointXY } from \"./Surface\";\nimport MovePoint from \"./MovePoint\";\nimport { inside } from \"../helpers/helpers\"; // typed earlier as (point, polygon, offset) => boolean\nimport Draggable, { DraggableJSON } from \"./Draggable\";\n\ntype PolyPointJSON = { i: number; x: number; y: number };\ntype PolyJSON = {\n  id: string | number;\n  type: \"POLY\";\n  x: number;\n  y: number;\n  points: PolyPointJSON[];\n};\n\nexport default class PolyMap extends Surface {\n  public points: MovePoint[] = [];\n\n  constructor(id: string | number, numPoints: number, buffer: any, pInst: any) {\n    // width/height/res are derived from points later; pass 0s for now\n    super(id, 0, 0, 2, \"POLY\", buffer, pInst);\n\n    // seed a regular n-gon\n    for (let i = 0; i < numPoints; i++) {\n      const r = 200;\n      const theta = (i / numPoints) * 2 * this.pInst.PI;\n      const x = r + r * Math.cos(theta);\n      const y = r + r * Math.sin(theta);\n      const cp = new MovePoint(this, x, y, this.pInst).setControlPoint(true);\n      this.points.push(cp);\n    }\n\n    this.setDimensions(this.points);\n  }\n\n  /** Replace all control points from raw coordinates. */\n  public setPoints(pts: ReadonlyArray<PointXY>): void {\n    this.points = [];\n    for (const p of pts) {\n      const cp = new MovePoint(this, p.x, p.y, this.pInst).setControlPoint(\n        true\n      );\n      this.points.push(cp);\n    }\n    this.setDimensions(this.points);\n  }\n\n  /**\n   * Draw the polygon.\n   * When `isUV` is true, Surface has set `textureMode(NORMAL)`,\n   * and we pass normalized UVs in [0,1] based on the polygons bounds,\n   * remapped into the provided rect (u0=v0=0, u1=v1=1 by default).\n   */\n  protected displaySurface(isUV = true, u0 = 0, v0 = 0, u1 = 1, v1 = 1): void {\n    if (this.points.length === 0) return;\n\n    const { x: minX, y: minY, w, h } = this.getBounds(this.points);\n    const rw = w > 0 ? w : 1;\n    const rh = h > 0 ? h : 1;\n\n    const mapU = (px: number) => u0 + ((px - minX) / rw) * (u1 - u0);\n    const mapV = (py: number) => v0 + ((py - minY) / rh) * (v1 - v0);\n\n    const p = this.pInst;\n    p.beginShape();\n    for (const pt of this.points) {\n      if (isUV) {\n        p.vertex(pt.x, pt.y, mapU(pt.x), mapV(pt.y));\n      } else {\n        p.vertex(pt.x, pt.y);\n      }\n    }\n    p.endShape(p.CLOSE);\n  }\n\n  public displayOutline(col: any = this.controlPointColor): void {\n    const p = this.pInst;\n    p.push();\n    p.strokeWeight(3);\n    p.stroke(col);\n    p.fill(this.getMutedControlColor());\n    // p.translate(this.x, this.y);\n    this.displaySurface(false);\n    p.pop();\n  }\n\n  /** Draw large handles while calibrating (reuses MovePoint.display). */\n  public displayControlPoints(): void {\n    const p = this.pInst;\n    p.push();\n    p.translate(this.x, this.y, 2);\n    for (const cp of this.points) cp.display(this.controlPointColor);\n    p.pop();\n  }\n\n  /**\n   * Hit test: check if mouse (in canvas coords) is inside the polygon\n   * after offsetting polygon by the surfaces position.\n   */\n  public isMouseOver(): boolean {\n    return inside(this.getMouseCoords(), this.points, { x: this.x, y: this.y });\n  }\n\n  /** Load persisted state (positions only). */\n  public load(json: DraggableJSON): void {\n    const { x, y, points } = json;\n    this.x = x;\n    this.y = y;\n\n    for (const point of points || []) {\n      const mp = this.points[point.i];\n      if (!mp) continue;\n      mp.x = point.x;\n      mp.y = point.y;\n    }\n    this.setDimensions(this.points);\n  }\n\n  /** Persist id/pos/type + point positions. */\n  public toJSON(): DraggableJSON {\n    const out: DraggableJSON = {\n      id: this.id,\n      x: this.x,\n      y: this.y,\n      type: \"POLY\",\n      points: [] as PolyPointJSON[],\n    };\n    for (let i = 0; i < this.points.length; i++) {\n      out.points?.push({ i, x: this.points[i].x, y: this.points[i].y });\n    }\n    return out;\n  }\n\n  /** Select a control point for dragging. */\n  public selectPoints(): MovePoint | null {\n    for (const cp of this.points) {\n      if (cp.isMouseOver()) {\n        cp.startDrag();\n        return cp;\n      }\n    }\n    return null;\n  }\n}\n","// Credit:\n// https://geeksoutofthebox.com/2020/11/23/simons-bezier-editor-in-p5-js/\n\n// ControlPoint.ts\nimport Draggable, { Point } from \"../Draggable\";\ntype P5 = any;\n\ntype P5Vec = {\n  x: number;\n  y: number;\n  set: (x: number, y: number) => void;\n  add: (x: number, y: number) => void;\n};\n\nexport type PathMode = \"AUTOMATIC\" | \"ALIGNED\" | \"MIRRORED\" | \"FREE\";\n\nexport interface ParentPath {\n  x: number;\n  y: number;\n  points: BezierPoint[];\n  mode: PathMode;\n  auto?: boolean;\n  controlPointColor: any;\n  loopIndex(i: number): number;\n  autoSetAllControlPoints(): void;\n  setDimensions(): void;\n}\n\nfunction dist(ax: number, ay: number, bx: number, by: number) {\n  const dx = ax - bx,\n    dy = ay - by;\n  return Math.hypot(dx, dy);\n}\n\nfunction setFromAnchorAlong(\n  out: { set: (x: number, y: number) => void },\n  ax: number,\n  ay: number,\n  px: number,\n  py: number,\n  length: number\n) {\n  // dir = anchor - point (keeps handles collinear)\n  let dx = ax - px,\n    dy = ay - py;\n  const mag = Math.hypot(dx, dy) || 1;\n  dx = (dx / mag) * length;\n  dy = (dy / mag) * length;\n  out.set(ax + dx, ay + dy);\n}\n\nfunction mirrorAcrossAnchor(\n  out: { set: (x: number, y: number) => void },\n  ax: number,\n  ay: number,\n  px: number,\n  py: number\n) {\n  // out = anchor + (anchor - point)\n  out.set(2 * ax - px, 2 * ay - py);\n}\n\nexport default class BezierPoint extends Draggable {\n  public readonly pInst: P5;\n  public readonly parentPath: ParentPath;\n\n  public type = \"CPOINT\";\n  public r = 8;\n\n  /** Local position (mirrors Draggable.x/y) */\n  public pos: P5Vec;\n\n  constructor(x: number, y: number, parentPath: ParentPath, pInst: P5) {\n    super(pInst, x, y);\n    // this.id = parentPath.points.length;\n    // super(pInst, x, y);\n    this.pInst = pInst;\n    this.pos = pInst.createVector(x, y);\n    this.parentPath = parentPath;\n    this.type = \"CPOINT\";\n    this.r = 8;\n  }\n\n  add(x: number, y: number) {\n    this.pos.add(x, y);\n  }\n\n  set(pos: Partial<Point>): this {\n    const { x, y } = pos;\n    this.pos.set(x || 0, y || 0);\n    return this;\n  }\n\n  isMouseOver() {\n    let px = this.pos.x + this.parentPath.x;\n    let py = this.pos.y + this.parentPath.y;\n    let mx = this.pInst.mouseX - this.pInst.width / 2;\n    let my = this.pInst.mouseY - this.pInst.height / 2;\n    if (this.pInst.dist(px, py, mx, my) < 5) {\n      return true;\n    }\n    return false;\n  }\n\n  moveTo() {\n    const x = this.pInst.mouseX - this.pInst.width / 2 - this.parentPath.x;\n    const y = this.pInst.mouseY - this.pInst.height / 2 - this.parentPath.y;\n\n    const closed = true;\n    const path = this.parentPath;\n    const i = path.points.indexOf(this);\n\n    if (i % 3 == 0) {\n      // anchor (red) points\n      const dx = x - this.pos.x;\n      const dy = y - this.pos.y;\n      this.pos.set(x, y);\n      if (i - 1 >= 0 || closed) {\n        path.points[path.loopIndex(i - 1)].add(dx, dy);\n      }\n      if (i + 1 < path.points.length || closed) {\n        path.points[path.loopIndex(i + 1)].add(dx, dy);\n      }\n      if (path.mode == \"AUTOMATIC\") path.autoSetAllControlPoints();\n    } else if (path.mode != \"AUTOMATIC\") {\n      // control (white) points\n      this.pos.set(x, y);\n      const anchorI = i % 3 == 1 ? i - 1 : i + 1;\n      const otherI = i % 3 == 1 ? i - 2 : i + 2;\n      if ((otherI >= 0 && otherI < path.points.length) || closed) {\n        const anchor = path.points[path.loopIndex(anchorI)].pos;\n        const other = path.points[path.loopIndex(otherI)].pos;\n        if (path.mode == \"ALIGNED\") {\n          const d = dist(anchor.x, anchor.y, other.x, other.y);\n          setFromAnchorAlong(\n            other,\n            anchor.x,\n            anchor.y,\n            this.pos.x,\n            this.pos.y,\n            d\n          );\n        } else if (path.mode == \"MIRRORED\") {\n          mirrorAcrossAnchor(other, anchor.x, anchor.y, this.pos.x, this.pos.y);\n        }\n      }\n    }\n    path.setDimensions();\n  }\n\n  isAnchor() {\n    const i = this.parentPath.points.indexOf(this);\n    return i % 3 == 0;\n  }\n\n  displayControlCircle(anchorCol: any, lighterCol: any) {\n    const i = this.parentPath.points.indexOf(this);\n    let colAnchor = anchorCol;\n    let colSelect = lighterCol;\n    if (this.isMouseOver()) {\n      colAnchor = this.pInst.color(255);\n      colSelect = this.pInst.color(200);\n    }\n    this.pInst.stroke(colAnchor);\n    this.pInst.strokeWeight(2);\n    if (i % 3 == 0) {\n      // anchor\n      this.displayCircle(colAnchor, this.r);\n    } else if (!this.parentPath.auto) {\n      //   let col = this.parentPath.controlPointColor;\n      this.displayCircle(colSelect, this.r - 2);\n    }\n  }\n\n  displayCircle(col: any, r: number) {\n    this.pInst.noFill();\n    this.pInst.stroke(col);\n    this.pInst.ellipse(this.pos.x, this.pos.y, r * 2);\n    this.pInst.noStroke();\n    this.pInst.fill(col);\n    this.pInst.ellipse(this.pos.x, this.pos.y, r);\n\n    // const i = this.parentPath.points.indexOf(this);\n    // text(i, this.pos.x, this.pos.y+20);\n  }\n}\n","// BezierMap.ts\n// Credit: https://geeksoutofthebox.com/2020/11/23/simons-bezier-editor-in-p5-js/\n\nimport Surface from \"../Surface\";\nimport BezierPoint from \"./BezierPoint\";\nimport { inside } from \"../../helpers/helpers\"; // assumes your typed helper\nimport { DraggableJSON } from \"../Draggable\";\n\ntype P5 = any;\n\ntype P5Vec = {\n  x: number;\n  y: number;\n  set: (x: number, y: number) => void;\n  add: (x: number, y: number) => void;\n};\n\nexport type BezierMode = \"FREE\" | \"ALIGNED\" | \"MIRRORED\" | \"AUTOMATIC\";\n\nexport interface PMapper {\n  // Shared 2D mask buffer for the Bezier (white mask)\n  bezBuffer: any; // p5.Graphics (2D)\n  // 2D buffer for the texture to be masked\n  buffer: any; // p5.Graphics (2D)\n  // WEBGL output buffer where the shader composes mask/texture\n  bufferWEBGL: any; // p5.Graphics (WEBGL)\n  // Whether shader assets / GL are ready\n  bezierShaderLoaded: boolean;\n}\n\nexport interface BezierJSONPoint {\n  x: number;\n  y: number;\n}\nexport interface BezierJSON {\n  id: string | number;\n  type: \"BEZ\";\n  x: number;\n  y: number;\n  points: BezierJSONPoint[];\n  closed: boolean;\n  auto: boolean;\n}\n\nexport default class BezierMap extends Surface {\n  public readonly pMapper: PMapper;\n  public mode: BezierMode = \"FREE\";\n  public r = 8;\n\n  /** Points laid out as [anchor, ctrl, ctrl, anchor, ctrl, ctrl, ...] */\n  public points: BezierPoint[] = [];\n\n  /** Whether first and last anchors connect and have control handles */\n  public closed = true;\n\n  /** Whether control points auto-update (AUTOMATIC mode helper) */\n  public auto = false;\n\n  /** Extra padding around the polygon bounds to avoid clipping the mask */\n  private bufferSpace = 10;\n\n  /** Cached shader (mask + image compose) */\n  private shaderProg: any | null = null;\n\n  constructor(\n    id: string | number,\n    numAnchors: number,\n    pMapper: PMapper,\n    pInst: P5\n  ) {\n    super(id, /*w*/ 0, /*h*/ 0, /*res*/ 2, \"BEZ\", pMapper.buffer, pInst);\n    this.pMapper = pMapper;\n\n    // give a nominal size; setDimensions() will update from bounds\n    this.width = 100;\n    this.height = 100;\n\n    this.initEmpty(numAnchors);\n  }\n\n  // --- Initialization ----------------------------------------------------\n\n  /** Create a closed ring of anchors/controls */\n  private initEmpty(numAnchors = 5): void {\n    this.points = [];\n    this.x = 0;\n    this.y = 0;\n\n    const r = 100; // ring radius\n    const lineW = 50; // initial handle distance\n\n    // first anchor (angle = 0) and its trailing control\n    {\n      const x = r * Math.cos(0);\n      const y = r * Math.sin(0);\n      const x0 = lineW * Math.cos(Math.PI / 2);\n      const y0 = -lineW * Math.sin(Math.PI / 2);\n      const x1 = -x0;\n      const y1 = -y0;\n\n      // anchor at (x,y), trailing control at (x+x1, y+y1)\n      this.points.push(new BezierPoint(x, y, this, this.pInst));\n      this.points.push(new BezierPoint(x + x1, y + y1, this, this.pInst));\n    }\n\n    // intermediate anchors + entering/leaving controls\n    for (let i = 1; i < numAnchors; i++) {\n      const ang = (i * 2 * Math.PI) / numAnchors;\n\n      const x = r * Math.cos(ang);\n      const y = r * Math.sin(ang);\n      const x0 = -lineW * Math.cos(Math.PI / 2 - ang);\n      const y0 = lineW * Math.sin(Math.PI / 2 - ang);\n      const x1 = -x0;\n      const y1 = -y0;\n\n      // enter control, anchor, exit control\n      this.points.push(new BezierPoint(x + x1, y + y1, this, this.pInst));\n      this.points.push(new BezierPoint(x, y, this, this.pInst));\n      this.points.push(new BezierPoint(x + x0, y + y0, this, this.pInst));\n    }\n\n    // close the ring with the last control\n    {\n      const last = this.points[this.points.length - 1].pos as P5Vec;\n      this.points.push(new BezierPoint(last.x, last.y, this, this.pInst));\n    }\n\n    this.closed = true;\n    this.auto = false;\n    this.setDimensions();\n  }\n\n  // --- Modes -------------------------------------------------------------\n\n  public setAlignedMode() {\n    this.mode = \"ALIGNED\";\n  }\n  public setMirroredMode() {\n    this.mode = \"MIRRORED\";\n  }\n  public setFreeMode() {\n    this.mode = \"FREE\";\n  }\n  public setAutomaticMode() {\n    this.mode = \"AUTOMATIC\";\n  }\n\n  /** p5 setting passthrough for curve quality */\n  public setBezierDetail(num = 20) {\n    this.pMapper.bezBuffer?.bezierDetail?.(num);\n    this.pMapper.buffer?.bezierDetail?.(num);\n  }\n\n  public isReady(): boolean {\n    return Boolean(this.pMapper.bezBuffer && this.pMapper.bezierShaderLoaded);\n  }\n\n  // --- Persistence -------------------------------------------------------\n\n  public load(json: DraggableJSON): void {\n    this.points = [];\n    this.x = json.x;\n    this.y = json.y;\n    this.closed = json.closed || false;\n    this.auto = json.auto || false;\n    for (const p of json.points || []) {\n      this.points.push(new BezierPoint(p.x, p.y, this, this.pInst));\n    }\n    this.setDimensions();\n  }\n\n  public getJson(): BezierJSON {\n    return {\n      id: this.id,\n      type: \"BEZ\",\n      x: this.x,\n      y: this.y,\n      points: this.points.map((p) => ({ x: p.pos.x, y: p.pos.y })),\n      closed: this.closed,\n      auto: this.auto,\n    };\n  }\n\n  public serialize(): string {\n    return JSON.stringify(this.getJson());\n  }\n\n  // --- Selection / Interaction ------------------------------------------\n\n  //   public selectSurface(): this | null {\n  //     if (this.isMouseOver()) {\n  //       this.startDrag();\n  //       return this;\n  //     }\n  //     return null;\n  //   }\n\n  public selectPoints(): BezierPoint | null {\n    const c = this.selectControls();\n    if (c) return c;\n    return this.selectAnchors();\n  }\n\n  private selectAnchors(): BezierPoint | null {\n    for (let i = 0; i < this.points.length; i += 3) {\n      const p = this.points[i];\n      if (p.isMouseOver()) return p;\n    }\n    return null;\n  }\n\n  private selectControls(): BezierPoint | null {\n    for (const p of this.points) {\n      if (p.isAnchor()) continue;\n      if (p.isMouseOver()) return p;\n    }\n    return null;\n  }\n\n  // --- Geometry helpers --------------------------------------------------\n\n  /** Axis-aligned bounds of the *polyline* approximation (in local coords) */\n  public override getBounds(): { x: number; y: number; w: number; h: number } {\n    const polyline = this.getPolyline();\n    return super.getBounds(polyline);\n  }\n\n  public loopIndex(i: number): number {\n    return (i + this.points.length) % this.points.length;\n  }\n\n  public toggleClosed(): void {\n    if (this.closed) {\n      this.closed = false;\n      // remove last two control points used to close the loop\n      this.points.pop();\n      this.points.pop();\n    } else {\n      this.closed = true;\n\n      const anchor1 = this.points[this.points.length - 1].pos as P5Vec;\n      const control1 = this.points[this.points.length - 2].pos as P5Vec;\n      const anchor2 = this.points[0].pos as P5Vec;\n      const control2 = this.points[1].pos as P5Vec;\n\n      const newControl1 = this.pInst.constructor.Vector.lerp(\n        anchor1,\n        control1,\n        -1\n      );\n      const cp1 = new BezierPoint(\n        newControl1.x,\n        newControl1.y,\n        this,\n        this.pInst\n      );\n\n      const newControl2 = this.pInst.constructor.Vector.lerp(\n        anchor2,\n        control2,\n        -1\n      );\n      const cp2 = new BezierPoint(\n        newControl2.x,\n        newControl2.y,\n        this,\n        this.pInst\n      );\n\n      this.points.push(cp1, cp2);\n    }\n\n    this.setDimensions();\n  }\n\n  public setDimensions(): void {\n    const { w, h } = this.getBounds();\n    this.width = w + this.bufferSpace * 2;\n    this.height = h + this.bufferSpace * 2;\n\n    // update the white mask into bezBuffer when shape changes\n    const bezBuffer = this.pMapper.bezBuffer;\n    this.displayBezierPG(bezBuffer);\n  }\n\n  public numSegments(): number {\n    return Math.floor(this.points.length / 3);\n  }\n\n  public getSegment(\n    i: number\n  ): [BezierPoint, BezierPoint, BezierPoint, BezierPoint] {\n    return [\n      this.points[this.loopIndex(i * 3 + 0)],\n      this.points[this.loopIndex(i * 3 + 1)],\n      this.points[this.loopIndex(i * 3 + 2)],\n      this.points[this.loopIndex(i * 3 + 3)],\n    ];\n  }\n\n  public addSegment(x?: number, y?: number): void {\n    // default to mouse in local space\n    const { x: mx, y: my } = this.getMouseCoords();\n    if (typeof x !== \"number\") x = mx - this.x;\n    if (typeof y !== \"number\") y = my - this.y;\n\n    const closestAnchorId = this.getClosestAnchor();\n    const nextClosestAnchorId = this.getNextClosestAnchor();\n\n    const prevControl = this.points[closestAnchorId + 1].pos as P5Vec;\n\n    let nextControlID = nextClosestAnchorId - 1;\n    if (nextControlID === -1) nextControlID = this.points.length - 1;\n    const nextControl = this.points[nextControlID].pos as P5Vec;\n\n    const anchor = this.pInst.createVector(x, y) as P5Vec;\n    const aP = new BezierPoint(anchor.x, anchor.y, this, this.pInst);\n\n    const control1 = this.pInst.constructor.Vector.lerp(\n      prevControl,\n      anchor,\n      1 - 0.3\n    );\n    const control2 = this.pInst.constructor.Vector.lerp(\n      anchor,\n      nextControl,\n      0.3\n    );\n\n    const cp1 = new BezierPoint(control1.x, control1.y, this, this.pInst);\n    const cp2 = new BezierPoint(control2.x, control2.y, this, this.pInst);\n\n    this.points.splice(closestAnchorId + 2, 0, cp1, aP, cp2);\n    this.setDimensions();\n  }\n\n  public removeSegment(): void {\n    if (this.points.length <= 3) {\n      console.warn(\"cannot have a bezier with less than one anchor\");\n      return;\n    }\n    for (let i = 0; i < this.points.length; i += 3) {\n      if (this.points[i].isMouseOver()) {\n        this.points.splice(i, 3);\n        this.setDimensions();\n        return;\n      }\n    }\n  }\n\n  public getClosestAnchor(): number {\n    const { x, y } = this.getMouseCoords();\n    const mx = x - this.x;\n    const my = y - this.y;\n\n    let minDis = Infinity;\n    let index = 0;\n\n    for (let i = 0; i < this.points.length; i += 3) {\n      const p0 = this.points[i];\n      const p1 =\n        i >= this.points.length - 3 ? this.points[0] : this.points[i + 3];\n\n      const d0 = this.pInst.dist(p0.pos.x, p0.pos.y, mx, my);\n      const d1 = this.pInst.dist(p1.pos.x, p1.pos.y, mx, my);\n      const cost = d0 + d1;\n\n      if (cost < minDis) {\n        minDis = cost;\n        index = i;\n      }\n    }\n    return index;\n  }\n\n  public getNextClosestAnchor(): number {\n    const anchor = this.getClosestAnchor();\n    let next = anchor + 3;\n    if (next > this.points.length - 3) next = 0;\n    return next;\n  }\n\n  public autoSetControlPoint(anchorI: number, controlSpacing: number): void {\n    if ((anchorI - 3 < 0 || anchorI + 3 >= this.points.length) && !this.closed)\n      return;\n\n    const anchorLeftI = this.loopIndex(anchorI - 3);\n    const anchorRightI = this.loopIndex(anchorI + 3);\n    const anchor = this.points[anchorI].pos as P5Vec;\n    const anchorLeft = this.points[anchorLeftI].pos as P5Vec;\n    const anchorRight = this.points[anchorRightI].pos as P5Vec;\n\n    const V = this.pInst.constructor.Vector;\n\n    const dispLeft = V.sub(V.copy(anchorLeft), anchor);\n    const dispRight = V.sub(V.copy(anchorRight), anchor);\n\n    const magLeft = dispLeft.mag();\n    const magRight = dispRight.mag();\n\n    dispLeft.normalize();\n    dispRight.normalize();\n\n    const dirLeft = V.sub(dispLeft, dispRight);\n    const dirRight = V.sub(dispRight, dispLeft);\n\n    dirLeft.setMag(magLeft * controlSpacing);\n    dirRight.setMag(magRight * controlSpacing);\n\n    this.points[this.loopIndex(anchorI - 1)].set(\n      V.add(V.copy(anchor), dirLeft)\n    );\n    this.points[this.loopIndex(anchorI + 1)].set(\n      V.add(V.copy(anchor), dirRight)\n    );\n  }\n\n  public autoSetEdgePoints(controlSpacing: number): void {\n    if (this.closed) return;\n\n    const V = this.pInst.constructor.Vector;\n\n    this.points[1].set(\n      V.lerp(this.points[0].pos, this.points[2].pos, controlSpacing)\n    );\n    this.points[this.points.length - 2].set(\n      V.lerp(\n        this.points[this.points.length - 1].pos,\n        this.points[this.points.length - 3].pos,\n        controlSpacing\n      )\n    );\n  }\n\n  public autoSetAllControlPoints(controlSpacing = 0.3): void {\n    for (let i = 0; i < this.points.length; i += 3) {\n      this.autoSetControlPoint(i, controlSpacing);\n    }\n    this.autoSetEdgePoints(controlSpacing);\n    this.setDimensions();\n  }\n\n  // --- Display -----------------------------------------------------------\n\n  public override display(col: any = this.pInst.color(\"black\")): void {\n    this.pInst.noStroke();\n    this.pInst.fill(col);\n    this.displayBezier();\n    this.displayCalib();\n  }\n\n  private displayCalib(): void {\n    if (this.pInst.isCalibratingMapper()) {\n      this.pInst.strokeWeight(3);\n      this.pInst.stroke(this.controlPointColor);\n      this.pInst.fill(this.getMutedControlColor());\n      this.displayBezier();\n    }\n  }\n\n  /** Composite an *image* through the Bezier mask using the shader */\n  public displayTexture(img: any, x = 0, y = 0, texW = 0, texH = 0): void {\n    if (!this.isReady()) return;\n\n    const buffer = this.pMapper.buffer;\n    this.drawImage(img, buffer, x, y, texW, texH);\n    this.displayGraphicsTexture(buffer);\n    this.displayCalib();\n  }\n\n  /** Draw a *sketch* into the buffer and then composite it through the mask */\n  public displaySketch(\n    sketch: (pg: any) => void,\n    x = 0,\n    y = 0,\n    tW = 0,\n    tH = 0\n  ): void {\n    const buffer = this.pMapper.buffer;\n    buffer.push();\n    buffer.translate(x, y);\n    sketch(buffer);\n    buffer.pop();\n    this.displayGraphicsTexture(buffer);\n  }\n\n  /** Apply mask (bezBuffer) to pBuffer via shader, draw to screen */\n  private displayGraphicsTexture(pBuffer: any): void {\n    if (!this.isReady()) return;\n\n    // update mask for current shape\n    this.setDimensions();\n\n    const pMask = this.pMapper.bezBuffer;\n    const pOutput = this.pMapper.bufferWEBGL;\n\n    // Lazily create and cache the shader\n    if (!this.shaderProg) {\n      const frag = `#ifdef GL_ES\nprecision mediump float;\n#endif\n\nvarying vec2 vTexCoord;\nuniform sampler2D texMask;\nuniform sampler2D texImg;\n\nvoid main() {\n  vec2 uv = vec2(vTexCoord.x, 1.0 - vTexCoord.y); // flip Y\n  vec4 maskT = texture2D(texMask, uv);\n  vec4 imgT  = texture2D(texImg,  uv);\n\n  float gray = (maskT.r + maskT.g + maskT.b) / 3.0;\n  vec3 outRGB = imgT.rgb * gray;\n\n  gl_FragColor = vec4(outRGB, gray);\n}`;\n      const vert = `#ifdef GL_ES\nprecision mediump float;\n#endif\n\nattribute vec3 aPosition;\nattribute vec2 aTexCoord;\nvarying vec2 vTexCoord;\n\nvoid main() {\n  vTexCoord = aTexCoord;\n  vec4 positionVec4 = vec4(aPosition, 1.0);\n  positionVec4.xy = positionVec4.xy * 2.0 - 1.0; // NDC\n  gl_Position = positionVec4;\n}`;\n      this.shaderProg = pOutput.createShader(vert, frag);\n    }\n\n    pOutput.clear();\n    pOutput.setAttributes(\"alpha\", true);\n    pOutput.shader(this.shaderProg);\n    this.shaderProg.setUniform(\"texMask\", pMask);\n    this.shaderProg.setUniform(\"texImg\", pBuffer);\n\n    pOutput.rect(0, 0, this.pInst.width, this.pInst.height);\n\n    const { x, y } = this.getBounds();\n    this.pInst.push();\n    this.pInst.translate(this.x, this.y);\n    this.pInst.translate(x - this.bufferSpace, y - this.bufferSpace);\n    this.pInst.image(pOutput, 0, 0);\n    this.pInst.pop();\n\n    this.displayCalib();\n  }\n\n  /** Draw img into pg; default size to intrinsic if not provided */\n  private drawImage(img: any, pg: any, x = 0, y = 0, texW = 0, texH = 0): void {\n    if (!img || !pg) return;\n    if (texW <= 0) texW = img.width;\n    if (texH <= 0) texH = img.height;\n\n    pg.push();\n    pg.clear();\n    pg.translate(x, y);\n    pg.image(img, 0, 0, texW, texH);\n    pg.pop();\n  }\n\n  /** Rasterize the white Bezier mask into the mask buffer */\n  private displayBezierPG(pg: any): void {\n    const { x, y } = this.getBounds();\n    pg.push();\n    pg.clear();\n    pg.fill(\"white\");\n    pg.translate(-x, -y);\n    pg.translate(this.bufferSpace, this.bufferSpace);\n\n    pg.beginShape();\n    pg.vertex(this.points[0].pos.x, this.points[0].pos.y);\n    for (let i = 0; i < this.numSegments(); i++) {\n      const seg = this.getSegment(i);\n      pg.bezierVertex(\n        seg[1].pos.x,\n        seg[1].pos.y,\n        seg[2].pos.x,\n        seg[2].pos.y,\n        seg[3].pos.x,\n        seg[3].pos.y\n      );\n    }\n    pg.endShape();\n    pg.pop();\n  }\n\n  /** Draw the path (no texture) in screen space for previews/calibration */\n  private displayBezier(): void {\n    this.pInst.push();\n    this.pInst.translate(this.x, this.y);\n    this.pInst.beginShape();\n    this.pInst.vertex(this.points[0].pos.x, this.points[0].pos.y);\n    for (let i = 0; i < this.numSegments(); i++) {\n      const seg = this.getSegment(i);\n      this.pInst.bezierVertex(\n        seg[1].pos.x,\n        seg[1].pos.y,\n        seg[2].pos.x,\n        seg[2].pos.y,\n        seg[3].pos.x,\n        seg[3].pos.y\n      );\n    }\n    this.pInst.endShape();\n    this.pInst.pop();\n  }\n\n  public displayControlPoints(): void {\n    if (!this.pInst.isMovingPoints?.()) return;\n\n    const lineC = this.controlPointColor;\n    this.pInst.push();\n    this.pInst.translate(this.x, this.y);\n    // if (!this.auto)\n    const lighterLineC = this.pInst.lerpColor(\n      lineC,\n      this.pInst.color(255, 255, 255),\n      0.5\n    );\n    this.displayControlLines(lighterLineC);\n    this.displayControlCircles(lineC, lighterLineC);\n    this.pInst.pop();\n  }\n\n  private displayControlLines(strokeC: any): void {\n    this.pInst.strokeWeight(2);\n    for (let i = 0; i < this.numSegments(); i++) {\n      const seg = this.getSegment(i);\n      this.pInst.stroke(strokeC);\n      this.pInst.line(seg[0].pos.x, seg[0].pos.y, seg[1].pos.x, seg[1].pos.y);\n      this.pInst.line(seg[2].pos.x, seg[2].pos.y, seg[3].pos.x, seg[3].pos.y);\n    }\n  }\n\n  private displayControlCircles(anchorCol: any, lighterCol: any): void {\n    let i = 0;\n    const index = this.getClosestAnchor();\n    const nextIndex = this.getNextClosestAnchor();\n    for (const p of this.points) {\n      //   let col = anchorCol;\n      //   if (i === index || i === nextIndex) col = this.pInst.color(255, 200, 200);\n      p.displayControlCircle(anchorCol, lighterCol);\n      i++;\n    }\n  }\n\n  /** Polyline approximation of the curve, in local coords */\n  private getPolyline(): Array<{ x: number; y: number }> {\n    const polyline: Array<{ x: number; y: number }> = [];\n    for (let i = 0; i < this.numSegments(); i++) {\n      const seg = this.getSegment(i);\n      const steps = 4; // sampling density per segment\n      for (let s = 0; s <= steps; s++) {\n        const t = s / steps;\n        const x = this.pInst.bezierPoint(\n          seg[0].pos.x,\n          seg[1].pos.x,\n          seg[2].pos.x,\n          seg[3].pos.x,\n          t\n        );\n        const y = this.pInst.bezierPoint(\n          seg[0].pos.y,\n          seg[1].pos.y,\n          seg[2].pos.y,\n          seg[3].pos.y,\n          t\n        );\n        polyline.push({ x, y });\n      }\n    }\n    return polyline;\n  }\n\n  /** Hit-test using the polyline and a ray cast in local space */\n  public isMouseOver(): boolean {\n    const polyline = this.getPolyline();\n    const mouse = this.getMouseCoords();\n    return inside(mouse, polyline, { x: this.x, y: this.y });\n  }\n}\n","// LineMap.ts\nimport { P5 } from \"../helpers/helpers\";\nimport Draggable, { DraggableJSON } from \"./Draggable\";\nimport MovePoint from \"./MovePoint\";\n\nexport type LineJson = {\n  id: string | number;\n  x: number;\n  y: number;\n  x0: number;\n  y0: number;\n  x1: number;\n  y1: number;\n};\n\ntype Vec = { x: number; y: number };\n\nexport default class LineMap extends Draggable {\n  public id: string | number;\n  public type = \"LINE\";\n\n  public lineW = 10;\n  public endCapsOn = true;\n\n  public p0: MovePoint;\n  public p1: MovePoint;\n\n  public lineC: any; // p5.Color\n  public highlightColor: any; // p5.Color\n  public controlPointColor: any; // p5.Color\n\n  private lastChecked = 0;\n  private ang = 0;\n\n  constructor(\n    x0: number,\n    y0: number,\n    x1: number,\n    y1: number,\n    id: string | number,\n    pInst: P5\n  ) {\n    super(pInst, 0, 0);\n    this.id = id;\n\n    this.lineC = this.pInst.color(255);\n    this.highlightColor = this.pInst.color(0, 255, 0);\n    this.controlPointColor = this.getLinearIdColor(this.id);\n\n    this.p0 = new MovePoint(this, x0, y0, this.pInst);\n    this.p1 = new MovePoint(this, x1, y1, this.pInst);\n\n    this.leftToRight();\n\n    // angle (used if needed for orientation)\n    this.ang = this.pInst.atan2(this.p0.y - this.p1.y, this.p0.x - this.p1.x);\n    if (this.ang > this.pInst.PI / 2) this.ang -= 2 * this.pInst.PI;\n  }\n\n  // ------------------------- Loading / Saving ----------------------------\n\n  load(json: DraggableJSON): void {\n    this.x = json.x;\n    this.y = json.y;\n    this.p0.x = json.x0 || 0;\n    this.p0.y = json.y0 || 0;\n    this.p1.x = json.x1 || 0;\n    this.p1.y = json.y1 || 0;\n  }\n\n  toJSON(): DraggableJSON {\n    return {\n      id: this.id,\n      x: this.x,\n      y: this.y,\n      x0: this.p0.x,\n      y0: this.p0.y,\n      x1: this.p1.x,\n      y1: this.p1.y,\n    };\n  }\n\n  // ------------------------------ Display --------------------------------\n\n  display(col: any = this.lineC, sw = this.lineW): void {\n    this.pInst.strokeWeight(sw);\n    this.pInst.stroke(col);\n    this.pInst.push();\n    this.pInst.translate(this.x, this.y);\n    this.pInst.line(this.p0.x, this.p0.y, this.p1.x, this.p1.y);\n    this.drawEndCaps(this.p0, this.p1, col, col, sw);\n    this.pInst.pop();\n  }\n\n  /** Pulses from the center toward endpoints */\n  displayCenterPulse(\n    per: number,\n    col: any = this.lineC,\n    sw = this.lineW\n  ): void {\n    const midX = (this.p0.x + this.p1.x) / 2;\n    const midY = (this.p0.y + this.p1.y) / 2;\n\n    const x0 = this.pInst.lerp(midX, this.p0.x, per);\n    const y0 = this.pInst.lerp(midY, this.p0.y, per);\n    const x1 = this.pInst.lerp(midX, this.p1.x, per);\n    const y1 = this.pInst.lerp(midY, this.p1.y, per);\n\n    this.pInst.strokeWeight(sw);\n    this.pInst.stroke(col);\n    this.pInst.push();\n    this.pInst.translate(this.x, this.y);\n    this.pInst.line(x0, y0, x1, y1);\n    this.drawEndCaps({ x: x0, y: y0 }, { x: x1, y: y1 }, col, col, sw);\n    this.pInst.pop();\n  }\n\n  /** Draws the line from p0 to a percent along toward p1 */\n  displayPercent(per: number, col: any = this.lineC, sw = this.lineW): void {\n    const t = this.pInst.constrain(per, 0, 1);\n    const x = this.pInst.lerp(this.p0.x, this.p1.x, t);\n    const y = this.pInst.lerp(this.p0.y, this.p1.y, t);\n\n    this.pInst.strokeWeight(sw);\n    this.pInst.stroke(col);\n    this.pInst.push();\n    this.pInst.translate(this.x, this.y);\n    this.pInst.line(this.p0.x, this.p0.y, x, y);\n    this.drawEndCaps(this.p0, { x, y }, col, col, sw);\n    this.pInst.pop();\n  }\n\n  /** Keeps the whole line but varies stroke width by percent */\n  displayPercentWidth(per: number, col: any = this.lineC): void {\n    const p = this.pInst.constrain(per, 0, 1);\n    const sw = this.pInst.map(p, 0, 1, 0, 10);\n    this.display(col, sw);\n  }\n\n  displayNone(): void {\n    this.display(this.pInst.color(0));\n  }\n\n  /** HSB hue cycle */\n  displayRainbowCycle(): void {\n    this.pInst.colorMode(this.pInst.HSB, 255);\n    const col = this.pInst.color(this.pInst.frameCount % 255, 255, 255);\n    this.display(col);\n    this.pInst.colorMode(this.pInst.RGB, 255);\n  }\n\n  /** Swept gradient segments along the line */\n  displayGradientLine(\n    c1: any,\n    c2: any,\n    per: number,\n    phase = 1,\n    flip = false\n  ): void {\n    // 'flip' kept for API compatibility (could invert gradient if desired)\n    let t = (per + phase) % 1;\n    const spacing = 1.0 / Math.max(1, this.pInst.height); // density guard\n\n    for (let i = 0; i < 1.0; i += spacing) {\n      const grad = (i / 2 + t) % 1;\n      const col = this.get2CycleColor(c1, c2, flip ? 1 - grad : grad);\n      this.displaySegment(i, spacing, col);\n    }\n  }\n\n  getCalibrationColor(): any {\n    this.pInst.colorMode(this.pInst.HSB, 255);\n    const h = this.pInst.hue(this.controlPointColor);\n    const col = this.pInst.color(h, 180, 255);\n    this.pInst.colorMode(this.pInst.RGB);\n    return col;\n  }\n\n  private getLinearIdColor(id: string | number): any {\n    const n = typeof id === \"number\" ? id : this.hashString(id.toString());\n    this.pInst.colorMode(this.pInst.HSB, 255);\n    const h = (n * 15) % 255;\n    const col = this.pInst.color(h, 255, 255);\n    this.pInst.colorMode(this.pInst.RGB);\n    return col;\n  }\n\n  // --------------------------- Display helpers ---------------------------\n\n  displayCalibration(): void {\n    if (this.isMouseOver()) this.display(this.pInst.color(255));\n    else this.display(this.getCalibrationColor());\n  }\n\n  displayControlPoints(): void {\n    this.pInst.push();\n    this.pInst.translate(this.x, this.y);\n    this.p0.display(this.controlPointColor);\n    this.p1.display(this.controlPointColor);\n    this.pInst.pop();\n  }\n\n  setEndCapsOn(): void {\n    this.endCapsOn = true;\n  }\n  setEndCapsOff(): void {\n    this.endCapsOn = false;\n  }\n\n  private drawEndCaps(\n    p0: Vec,\n    p1: Vec,\n    col0: any = this.lineC,\n    col1: any = this.lineC,\n    sw = this.lineW\n  ): void {\n    if (!this.endCapsOn) return;\n    if (this.pInst.dist(p0.x, p0.y, p1.x, p1.y) <= 1) return;\n\n    this.pInst.noStroke();\n    this.pInst.fill(col0);\n    this.pInst.ellipse(p0.x, p0.y, sw);\n    this.pInst.fill(col1);\n    this.pInst.ellipse(p1.x, p1.y, sw);\n  }\n\n  /** Draws a segment between t in [startPer, startPer+sizePer] */\n  displaySegment(\n    startPer: number,\n    sizePer: number,\n    col: any = this.lineC,\n    sw = this.lineW\n  ): void {\n    const t0 = this.pInst.constrain(startPer, 0, 1);\n    const t1 = this.pInst.constrain(startPer + sizePer, 0, 1);\n\n    const x0 = this.pInst.lerp(this.p0.x, this.p1.x, t0);\n    const y0 = this.pInst.lerp(this.p0.y, this.p1.y, t0);\n    const x1 = this.pInst.lerp(this.p0.x, this.p1.x, t1);\n    const y1 = this.pInst.lerp(this.p0.y, this.p1.y, t1);\n\n    this.pInst.strokeWeight(sw);\n    this.pInst.stroke(col);\n\n    this.pInst.push();\n    this.pInst.translate(this.x, this.y);\n    this.pInst.line(x0, y0, x1, y1);\n    this.drawEndCaps({ x: x0, y: y0 }, { x: x1, y: y1 }, col, col, sw);\n    this.pInst.pop();\n  }\n\n  // ------------------------------ Color utils ----------------------------\n\n  get2CycleColor(c1: any, c2: any, per: number): any {\n    const t = this.pInst.constrain(per, 0, 1) * 2;\n    if (t < 1) return this.pInst.lerpColor(c1, c2, t);\n    return this.pInst.lerpColor(c2, c1, this.pInst.map(t, 1, 2, 0, 1));\n  }\n\n  get3CycleColor(c1: any, c2: any, per: number): any {\n    const t = this.pInst.constrain(per, 0, 1) * 3;\n    if (t < 1) return this.pInst.lerpColor(c1, c2, t);\n    if (t < 2)\n      return this.pInst.lerpColor(c2, c1, this.pInst.map(t, 1, 2, 1, 0));\n    return this.pInst.lerpColor(c1, c2, this.pInst.map(t, 2, 3, 1, 0));\n  }\n\n  getPointHighlight(_p: Vec): void {\n    // You can enhance hover visuals here if desired.\n    this.pInst.stroke(255, 0, 0);\n  }\n\n  // ---------------------------- Hit detection ----------------------------\n\n  /** Local-space hit test against the line (distance-to-segment) */\n  isMouseOver(): boolean {\n    const { x: mx, y: my } = this.getMouseCoords();\n    const px = mx - this.x;\n    const py = my - this.y;\n\n    const x1 = this.p0.x,\n      y1 = this.p0.y;\n    const x2 = this.p1.x,\n      y2 = this.p1.y;\n\n    const lineLen = this.pInst.dist(x1, y1, x2, y2);\n    if (lineLen < 1e-6) return false;\n\n    // project point onto segment and clamp\n    const t = this.clamp(this.projectParam(px, py, x1, y1, x2, y2), 0, 1);\n    const cx = this.pInst.lerp(x1, x2, t);\n    const cy = this.pInst.lerp(y1, y2, t);\n\n    // tolerance scales with lineW\n    const tol = Math.max(2, this.lineW * 0.6);\n    const distToLine = this.pInst.dist(px, py, cx, cy);\n    const isOver = distToLine <= tol;\n    return isOver;\n  }\n\n  isMouseOverCallback(callback: (self: LineMap) => void): void {\n    if (this.isMouseOver()) callback(this);\n  }\n\n  selectPoints() {\n    if (this.p0.isMouseOver()) {\n      this.p0.startDrag();\n      return this.p0;\n    }\n    if (this.p1.isMouseOver()) {\n      this.p1.startDrag();\n      return this.p1;\n    }\n    return null;\n  }\n\n  // ------------------------------ Utilities ------------------------------\n\n  leftToRight(): void {\n    if (this.p0.x > this.p1.x) {\n      const tmp = this.pInst.createVector(this.p0.x, this.p0.y);\n      this.p0.set(this.p1);\n      this.p1.set(tmp);\n    }\n  }\n\n  rightToLeft(): void {\n    if (this.p0.x < this.p1.x) {\n      const tmp = this.pInst.createVector(this.p0.x, this.p0.y);\n      this.p0.set(this.p1);\n      this.p1.set(tmp);\n    }\n  }\n\n  displayNumber(): void {\n    this.pInst.push();\n    this.pInst.noStroke();\n    this.pInst.fill(255);\n    const mx = (this.p0.x + this.p1.x) / 2;\n    const my = (this.p0.y + this.p1.y) / 2;\n    this.pInst.text(this.id.toString(), this.x + mx + 10, this.y + my);\n    this.pInst.pop();\n  }\n\n  // param of projection of P onto AB\n  private projectParam(\n    px: number,\n    py: number,\n    ax: number,\n    ay: number,\n    bx: number,\n    by: number\n  ): number {\n    const vx = bx - ax,\n      vy = by - ay;\n    const wx = px - ax,\n      wy = py - ay;\n    const vv = vx * vx + vy * vy;\n    if (vv <= 1e-12) return 0;\n    return (wx * vx + wy * vy) / vv;\n  }\n\n  private clamp(v: number, lo: number, hi: number): number {\n    return Math.max(lo, Math.min(hi, v));\n  }\n\n  private hashString(s: string): number {\n    // simple, stable string hash for color variation\n    let h = 2166136261 >>> 0;\n    for (let i = 0; i < s.length; i++) {\n      h ^= s.charCodeAt(i);\n      h = Math.imul(h, 16777619);\n    }\n    return h >>> 0;\n  }\n}\n","// ProjectionMapper.ts\nimport QuadMap from \"./surfaces/QuadMap\";\nimport TriMap from \"./surfaces/TriMap\";\nimport PolyMap from \"./surfaces/PolyMap\";\nimport BezierMap from \"./surfaces/Bezier/BezierMap\";\nimport LineMap, { LineJson } from \"./surfaces/LineMap\";\nimport { getPercentWave } from \"./helpers/helpers\";\nimport Surface from \"./surfaces/Surface\";\nimport Draggable from \"./surfaces/Draggable\";\n\n// ---- Minimal p5 typings (relaxed) ----\ntype P5 = any;\n\n// ---- Surface/Shape interfaces used here ----\nexport interface JsonSurface {\n  id: number | string;\n  type: \"TRI\" | \"QUAD\" | \"BEZ\" | \"POLY\";\n  x: number;\n  y: number;\n  [k: string]: any;\n}\n\ntype Selectable = Surface | LineMap;\n\ntype MoveMode = \"ALL\" | \"SURFACES\" | \"POINTS\";\n\nclass ProjectionMapper {\n  // drawing buffers\n  public buffer!: P5; // 2D for composing textures\n  public bufferWEBGL!: P5; // WEBGL output for shader comp\n  public bezBuffer!: P5; // mask for Bezier\n\n  // shapes\n  public surfaces: Draggable[] = [];\n  public lines: LineMap[] = [];\n\n  // interaction\n  private dragged: Draggable | null = null;\n  private selected: Draggable | null = null;\n  private pMousePressed = false;\n  private moveMode: MoveMode = \"ALL\";\n\n  // state & env\n  public calibrate = false;\n  public pInst: P5 | null = null;\n\n  // shaders\n  private bezShader: any = null;\n  public bezierShaderLoaded = false;\n\n  constructor() {}\n\n  // --------------------------- Lifecycle ---------------------------\n\n  preload(shader: any) {\n    this.bezShader = shader;\n    this.bezierShaderLoaded = true;\n  }\n\n  init(w: number, h: number) {\n    if (!this.pInst) throw new Error(\"ProjectionMapper.init: pInst not set\");\n    if (this.buffer && this.bezBuffer && this.bufferWEBGL) return; // idempotent\n\n    this.bufferWEBGL = this.pInst.createGraphics(w, h, this.pInst.WEBGL);\n    this.buffer = this.pInst.createGraphics(w, h);\n    this.bezBuffer = this.pInst.createGraphics(w, h);\n\n    // if no external shader was preloaded, make one locally\n    if (!this.bezierShaderLoaded) this.initPMapperShaderStr();\n  }\n\n  // build shader from strings (fallback)\n  private initPMapperShaderStr() {\n    const frag = `\n      #ifdef GL_ES\n      precision mediump float;\n      #endif\n      varying vec2 vTexCoord;\n      uniform sampler2D texMask;\n      uniform sampler2D texImg;\n      void main() {\n        vec2 uv = vTexCoord;\n        uv.y = 1.0 - uv.y;\n        vec4 maskT = texture2D(texMask, uv);\n        vec4 imgT = texture2D(texImg, uv);\n        float gray = (maskT.r + maskT.g + maskT.b) / 3.0;\n        vec3 thresh = imgT.rgb * gray;\n        gl_FragColor = vec4(thresh, gray);\n      }`;\n\n    const vert = `\n      #ifdef GL_ES\n      precision mediump float;\n      #endif\n      attribute vec3 aPosition;\n      attribute vec2 aTexCoord;\n      varying vec2 vTexCoord;\n      void main() {\n        vTexCoord = aTexCoord;\n        vec4 p = vec4(aPosition, 1.0);\n        p.xy = p.xy * 2.0 - 1.0;\n        gl_Position = p;\n      }`;\n\n    this.bezShader = this.bufferWEBGL.createShader(vert, frag);\n    this.bezierShaderLoaded = true;\n  }\n\n  // --------------------------- Factories ---------------------------\n\n  /** Creates and registers a new quad surface. */\n  createQuadMap(w: number, h: number, res = 20) {\n    if (!this.pInst || !this.buffer)\n      throw new Error(\"ProjectionMapper not initialized\");\n    const s = new QuadMap(\n      this.surfaces.length,\n      w,\n      h,\n      res,\n      this.buffer,\n      this.pInst\n    );\n    this.surfaces.push(s);\n    return s;\n  }\n\n  /** Creates and registers a new triangle surface. */\n  createTriMap(w: number, h: number, res = 20) {\n    if (!this.pInst || !this.buffer)\n      throw new Error(\"ProjectionMapper not initialized\");\n    const s = new TriMap(\n      this.surfaces.length,\n      w,\n      h,\n      res,\n      this.buffer,\n      this.pInst\n    );\n    this.surfaces.push(s);\n    return s;\n  }\n\n  /** Creates and registers a new poly surface. */\n  createPolyMap(numPoints = 3) {\n    if (!this.pInst || !this.buffer)\n      throw new Error(\"ProjectionMapper not initialized\");\n    const n = Math.max(3, Math.floor(numPoints));\n    const s = new PolyMap(this.surfaces.length, n, this.buffer, this.pInst);\n    this.surfaces.push(s);\n    return s;\n  }\n\n  /** Creates and registers a new Bezier surface. */\n  createBezierMap(numPoints = 5) {\n    if (!this.pInst) throw new Error(\"ProjectionMapper not initialized\");\n    const bez = new BezierMap(\n      this.surfaces.length,\n      numPoints,\n      this,\n      this.pInst\n    );\n    this.surfaces.push(bez);\n    return bez;\n  }\n\n  /** Creates and registers a new line. */\n  createLineMap(x0 = 0, y0 = 0, x1 = 0, y1 = 0) {\n    if (!this.pInst) throw new Error(\"ProjectionMapper not initialized\");\n    // default stagger\n    if (x0 === 0 && y0 === 0 && x1 === 0 && y1 === 0) {\n      x1 = 200;\n      y0 = 30 * this.lines.length;\n      y1 = 30 * this.lines.length;\n    }\n    const l = new LineMap(x0, y0, x1, y1, this.lines.length, this.pInst);\n    this.lines.push(l);\n    return l;\n  }\n\n  // --------------------------- Interaction ---------------------------\n\n  onClick() {\n    if (!this.calibrate) return;\n\n    if (this.moveMode === \"SURFACES\") {\n      this.checkSurfacesClick();\n    } else if (this.moveMode === \"POINTS\") {\n      this.checkPointsClick();\n    } else {\n      if (!this.checkPointsClick()) this.checkSurfacesClick();\n    }\n  }\n\n  moveSurfaces() {\n    this.moveMode = \"SURFACES\";\n  }\n  moveControlPoints() {\n    this.moveMode = \"POINTS\";\n  }\n  moveAll() {\n    this.moveMode = \"ALL\";\n  }\n\n  isMovingPoints(): boolean {\n    return this.moveMode === \"ALL\" || this.moveMode === \"POINTS\";\n  }\n\n  private checkSurfacesClick(): boolean {\n    // lines (topmost-first)\n    for (let i = this.lines.length - 1; i >= 0; i--) {\n      const s = this.lines[i];\n      this.dragged = s.selectDraggable();\n      if (this.dragged) return true;\n    }\n    // surfaces\n    for (let i = this.surfaces.length - 1; i >= 0; i--) {\n      const s = this.surfaces[i];\n      this.dragged = s.selectDraggable();\n      if (this.dragged) {\n        this.selected = s;\n        return true;\n      }\n    }\n    this.selected = null;\n    return false;\n  }\n\n  private checkPointsClick(): boolean {\n    // lines\n    for (let i = this.lines.length - 1; i >= 0; i--) {\n      const s = this.lines[i];\n      this.dragged = s.selectPoints();\n      if (this.dragged) return true;\n    }\n    // surfaces\n    for (let i = this.surfaces.length - 1; i >= 0; i--) {\n      const s = this.surfaces[i];\n      this.dragged = s.selectPoints();\n      if (this.dragged) {\n        this.selected = s;\n        return true;\n      }\n    }\n    this.selected = null;\n    return false;\n  }\n\n  onDrag() {\n    if (this.dragged && this.dragged.moveTo) this.dragged.moveTo();\n  }\n\n  onRelease() {\n    this.dragged = null;\n  }\n\n  isDragging(surface: Selectable): boolean {\n    return this.dragged === surface;\n  }\n\n  updateEvents() {\n    if (!this.pInst) return;\n    if (this.pInst.mouseIsPressed) {\n      if (!this.pMousePressed) this.onClick();\n      else this.onDrag();\n    } else {\n      if (this.pMousePressed) this.onRelease();\n    }\n    this.pMousePressed = this.pInst.mouseIsPressed;\n  }\n\n  // --------------------------- Loading/Saving ---------------------------\n\n  load(filepath = \"maps/map.json\", callback?: () => void) {\n    if (!this.pInst) throw new Error(\"ProjectionMapper not initialized\");\n    this.pInst.loadJSON(\n      filepath,\n      (json: { surfaces?: JsonSurface[]; lines?: LineJson[] }) => {\n        this.loadedJson(json);\n        if (callback) callback();\n      },\n      (err: any) => console.warn(`error loading ${filepath}`, err)\n    );\n  }\n\n  private loadedJson(json: { surfaces?: JsonSurface[]; lines?: LineJson[] }) {\n    if (json.surfaces) this.loadSurfaces(json.surfaces);\n    if (json.lines) this.loadLines(json.lines);\n  }\n\n  private loadSurfaces(jSurfaces: JsonSurface[]) {\n    if (jSurfaces.length !== this.surfaces.length) {\n      console.warn(\n        `json has ${jSurfaces.length} surfaces but memory has ${this.surfaces.length} surfaces`\n      );\n    }\n\n    const filterBy = (t: JsonSurface[\"type\"]) =>\n      jSurfaces.filter((s) => s.type === t);\n    const mapBy = (t: JsonSurface[\"type\"]) =>\n      this.surfaces.filter((s) => (s as any).type === t);\n\n    const loadTyped = (t: JsonSurface[\"type\"]) => {\n      const js = filterBy(t);\n      const ms = mapBy(t);\n      let i = 0;\n      while (i < js.length && i < ms.length) {\n        const surface = ms[i];\n        const j = js[i];\n        if (surface.isEqual({ id: j.id, type: j.type })) {\n          surface.load(j);\n        } else console.warn(\"mismatch between calibration surface types/ids\");\n\n        i++;\n      }\n    };\n\n    loadTyped(\"TRI\");\n    loadTyped(\"QUAD\");\n    loadTyped(\"BEZ\");\n    loadTyped(\"POLY\");\n  }\n\n  private loadLines(jLines: LineJson[]) {\n    if (jLines.length !== this.lines.length) {\n      console.warn(\n        `json has ${jLines.length} lines but memory has ${this.lines.length} lines`\n      );\n    }\n    for (let i = 0; i < Math.min(jLines.length, this.lines.length); i++) {\n      this.lines[i].load(jLines[i]);\n    }\n  }\n\n  save(filename = \"map.json\") {\n    if (!this.pInst) return;\n    const json = {\n      surfaces: this.surfaces.map((s) => s.toJSON()).filter(Boolean),\n      lines: this.lines.map((l) => l.toJSON()),\n    };\n    this.pInst.saveJSON(json, filename);\n  }\n\n  // --------------------------- Calibration ---------------------------\n\n  startCalibration() {\n    this.calibrate = true;\n  }\n  stopCalibration() {\n    this.calibrate = false;\n  }\n  toggleCalibration() {\n    this.calibrate = !this.calibrate;\n  }\n\n  // --------------------------- Rendering hooks ---------------------------\n\n  displayControlPoints() {\n    if (!this.calibrate) return;\n\n    for (const s of this.surfaces) {\n      if (s instanceof Surface) s.displayControlPoints();\n    }\n\n    for (const l of this.lines) {\n      l.displayCalibration();\n      l.displayControlPoints();\n    }\n  }\n\n  // small util exposed\n  getOscillator(seconds: number, offset = 0) {\n    if (!this.pInst) return 0;\n    return getPercentWave(this.pInst, seconds, offset);\n  }\n\n  // shader access for BezierMap\n  getBezierShader() {\n    return this.bezShader;\n  }\n}\n\nconst pMapper = new ProjectionMapper();\n\n// --------------------------- p5 Integration ---------------------------\n\ndeclare const p5: any;\n\ndeclare global {\n  interface Window {\n    p5: any;\n  }\n}\n\ndeclare global {\n  interface p5 {\n    createProjectionMapper(pInst: P5, w?: number, h?: number): ProjectionMapper;\n    isCalibratingMapper(): boolean;\n    isMovingPoints(): boolean;\n    isDragging(surface: Selectable): boolean;\n    initPMapperShader(): void;\n  }\n}\n\np5.prototype.createProjectionMapper = function (\n  pInst: P5,\n  w?: number,\n  h?: number\n) {\n  const W = w ?? pInst.width;\n  const H = h ?? pInst.height;\n  pMapper.pInst = pInst;\n  pMapper.init(W, H);\n  return pMapper;\n};\n\np5.prototype.isCalibratingMapper = function () {\n  return pMapper.calibrate;\n};\n\np5.prototype.isMovingPoints = function () {\n  return pMapper.isMovingPoints();\n};\n\np5.prototype.isDragging = function (surface: Selectable) {\n  return pMapper.isDragging(surface);\n};\n\np5.prototype.initPMapperShader = function () {\n  const filePath =\n    \"https://cdn.statically.io/gh/jdeboi/p5.mapper/main/src/surfaces/Bezier/shader\";\n  this.loadShader(filePath + \".vert\", filePath + \".frag\", (bezShader: any) =>\n    pMapper.preload(bezShader)\n  );\n};\n\n// Use a single 'post' hook to avoid overriding each other\np5.prototype.registerMethod(\"post\", () => {\n  pMapper.displayControlPoints();\n  pMapper.updateEvents();\n});\n\nexport default pMapper;\n"],"names":["numeric","dim","x","y","z","_typeof","_dim","length","_foreach2","s","k","f","i","n","ret","Array","cloneV","_n","clone","V","diag","d","i1","j","A","Ai","rep","v","identity","inv","a","abs","Math","m","Aj","I","Ii","Ij","i0","v0","dotMMsmall","p","q","r","foo","bar","woo","dotMV","dotVV","transpose","A0","A1","Bj","round","num","getNormalizationCoefficients","srcPts","dstPts","isInverse","tmp","r1","r2","r3","r4","r5","r6","r7","r8","matA","matB","matC","e","console","log","matD","matX","PerspT","window","undefined","coeffs","coeffsInv","prototype","transform","coordinates","transformInverse","Draggable","pInst","arguments","_classCallCheck","_defineProperty","xStartDrag","yStartDrag","_createClass","key","value","setEnabled","enabled","_enabled","_dragging","endDrag","get","setLockAxis","axis","_axis","setBounds","bounds","_bounds","applyBounds","setGrid","step","_grid","isArray","max","startDrag","_this$onDragStart","mx","mouseX","my","mouseY","clickX","clickY","onDragStart","call","moveTo","_this$onDragMove2","_this$onDragMove","pos","applyConstraints","onDragMove","nx","ny","translate","dx","dy","getIsDragging","getIsEnabled","updateDrag","_this$onDragMove3","_this$onDragEnd","onDragEnd","selectDraggable","isMouseOver","selectPoints","Error","set","getMouseCoords","width","height","error","_this$_bounds","w","h","clamp","_this$_grid","_slicedToArray","gx","gy","toJSON","dragging","load","data","isEqual","json","default","b","MovePoint","_Draggable","parent","_opts$radius","_opts$hitScale","_opts$color","_this","opts","_callSuper","radius","hitScale","col","color","_inherits","point","moveToMouse","_this$getLocalMouse","getLocalMouse","mxLocal","myLocal","setControlPoint","cp","isControlPoint","setRadius","setColor","c","setHitScale","scale","_this$toLocal","toLocal","rr","pow","interpolateBetween","start","end","display","isMovingPoints","push","stroke","strokeWeight","noFill","ellipse","fill","noStroke","pop","_renderer","_this$parent$x","_this$parent","_this$parent$y","_this$parent2","isWEBGL","isP3D","px","py","clamp01","MeshPoint","_MovePoint","u","_superPropGet","calculateMesh","interpolateTo","nX","nY","inside","polygon","offset","isInside","xi","yi","xj","yj","straddles","xCross","getRandomizedColor","id","type","p5","shapeOffset","charCodeAt","colorMode","HSB","RGB","getPercent","seconds","constrain","frameCount","getPercentWave","sin","PI","Surface","res","buffer","Number","isInteger","concat","controlPointColor","createBuffer","g","createGraphics","floor","clear","getMutedControlColor","alpha","red","green","blue","background","displayTexture","displaySurface","isUV","u0","u1","v1","warn","displaySketch","sketch","tX","tY","texW","texH","tex","textureMode","NORMAL","texture","isCalibratingMapper","displayCalibration","displayOutline","toString","getBounds","points","minX","Infinity","minY","maxX","maxY","_iterator","_createForOfIteratorHelper","_step","done","pt","err","ceil","setDimensions","_this$getBounds","setSize","newW","newH","scheduleCalculateMesh","_this2","rafHandle","raf","requestAnimationFrame","setTimeout","displayControlPoints","CornerPinSurface","_Surface","initMesh","idx","forEachPoint","fn","mesh","mapX","mapY","mapU","mapV","TL","TR","BL","BR","forEach","controlPoints","setPerspectiveTransform","perspectiveTransform","mp","String","_x","_y","_data$points","getControlPoints","isMouseOverControlPoints","_iterator2","_step2","isPointInTriangle","v0x","v0y","v1x","v1y","v2x","v2y","dot00","dot01","dot02","dot11","dot12","invDen","_iterator3","_step3","getTransformedCursor","cx","cy","createVector","_this$perspectiveTran","_this$perspectiveTran2","tx","ty","getTransformedMouse","_this$getMouseCoords","cross2","x0","y0","x1","y1","QuadMap","_CornerPinSurface","resX","resY","srcCorners","dstCorners","persp","stepX","stepY","sx","sy","_persp$transform","_persp$transform2","beginShape","TRIANGLES","emitQuadAsTrianglesUV","emitQuadAsTrianglesOutline","endShape","displayGrid","i00","i10","i11","i01","put","uu","vv","vertex","_this3","setResolution","_initMesh","_ref","TriMap","setTriMesh","TP","xTop","apex","bl","br","uv","uMid","CLOSE","PolyMap","numPoints","theta","cos","setPoints","pts","rw","rh","_iterator4","_step4","out","_out$points","_iterator5","_step5","dist","ax","ay","bx","by","hypot","setFromAnchorAlong","mag","mirrorAcrossAnchor","BezierPoint","parentPath","add","closed","path","indexOf","loopIndex","mode","autoSetAllControlPoints","anchorI","otherI","anchor","other","isAnchor","displayControlCircle","anchorCol","lighterCol","colAnchor","colSelect","displayCircle","auto","BezierMap","numAnchors","pMapper","initEmpty","lineW","ang","last","setAlignedMode","setMirroredMode","setFreeMode","setAutomaticMode","setBezierDetail","_this$pMapper$bezBuff","_this$pMapper$bezBuff2","_this$pMapper$buffer","_this$pMapper$buffer$","bezBuffer","bezierDetail","isReady","Boolean","bezierShaderLoaded","getJson","map","serialize","JSON","stringify","selectControls","selectAnchors","polyline","getPolyline","toggleClosed","anchor1","control1","anchor2","control2","newControl1","constructor","Vector","lerp","cp1","newControl2","cp2","bufferSpace","displayBezierPG","numSegments","getSegment","addSegment","closestAnchorId","getClosestAnchor","nextClosestAnchorId","getNextClosestAnchor","prevControl","nextControlID","nextControl","aP","splice","removeSegment","_this$getMouseCoords2","minDis","index","p0","p1","d0","d1","cost","next","autoSetControlPoint","controlSpacing","anchorLeftI","anchorRightI","anchorLeft","anchorRight","dispLeft","sub","copy","dispRight","magLeft","magRight","normalize","dirLeft","dirRight","setMag","autoSetEdgePoints","displayBezier","displayCalib","img","drawImage","displayGraphicsTexture","tW","tH","pBuffer","pMask","pOutput","bufferWEBGL","shaderProg","frag","vert","createShader","setAttributes","shader","setUniform","rect","_this$getBounds2","image","pg","_this$getBounds3","seg","bezierVertex","_this$pInst$isMovingP","_this$pInst","lineC","lighterLineC","lerpColor","displayControlLines","displayControlCircles","strokeC","line","nextIndex","steps","t","bezierPoint","mouse","LineMap","highlightColor","getLinearIdColor","leftToRight","atan2","sw","drawEndCaps","displayCenterPulse","per","midX","midY","displayPercent","displayPercentWidth","displayNone","displayRainbowCycle","displayGradientLine","c1","c2","phase","flip","spacing","grad","get2CycleColor","displaySegment","getCalibrationColor","hue","hashString","setEndCapsOn","endCapsOn","setEndCapsOff","col0","col1","startPer","sizePer","t0","t1","get3CycleColor","getPointHighlight","_p","x2","y2","lineLen","projectParam","tol","distToLine","isOver","isMouseOverCallback","callback","rightToLeft","displayNumber","text","vx","vy","wx","wy","lo","hi","min","imul","ProjectionMapper","preload","bezShader","init","WEBGL","initPMapperShaderStr","createQuadMap","surfaces","createTriMap","createPolyMap","createBezierMap","bez","createLineMap","lines","l","onClick","calibrate","moveMode","checkSurfacesClick","checkPointsClick","moveSurfaces","moveControlPoints","moveAll","dragged","selected","onDrag","onRelease","isDragging","surface","updateEvents","mouseIsPressed","pMousePressed","filepath","loadJSON","loadedJson","loadSurfaces","loadLines","jSurfaces","filterBy","filter","mapBy","loadTyped","js","ms","jLines","save","filename","saveJSON","startCalibration","stopCalibration","toggleCalibration","getOscillator","getBezierShader","createProjectionMapper","W","H","initPMapperShader","filePath","loadShader","registerMethod"],"sourceRoot":""}